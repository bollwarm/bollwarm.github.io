{"id":832,"date":"2015-12-10T21:47:47","date_gmt":"2015-12-10T13:47:47","guid":{"rendered":"http:\/\/ijz.me\/?p=832"},"modified":"2015-12-10T21:47:47","modified_gmt":"2015-12-10T13:47:47","slug":"rex-advent-rex-%e5%88%a9%e7%94%a8augeas%e6%a8%a1%e5%9d%97%e8%bf%9b%e8%a1%8c%e6%96%87%e4%bb%b6%e9%85%8d%e7%bd%ae","status":"publish","type":"post","link":"http:\/\/ijz.me\/?p=832","title":{"rendered":"rex advent\u2014\u2014rex \u5229\u7528Augeas\u6a21\u5757\u8fdb\u884c\u6587\u4ef6\u914d\u7f6e"},"content":{"rendered":"<p>1\u3001Augeas\u662f\u4ec0\u4e48?<\/p>\n<p>Augeas\u57fa\u672c\u4e0a\u5c31\u662f\u4e00\u4e2a\u914d\u7f6e\u7f16\u8f91\u5de5\u5177\u3002\u5b83\u4ee5\u4ed6\u4eec\u539f\u751f\u7684\u683c\u5f0f\u89e3\u6790\u914d\u7f6e\u6587\u4ef6\u5e76\u4e14\u5c06\u5b83\u4eec\u8f6c\u6362\u6210\u6811\u3002\u914d\u7f6e\u7684\u66f4\u6539\u53ef\u4ee5\u901a\u8fc7\u64cd\u4f5c\u6811\u6765\u5b8c\u6210\uff0c\u5e76\u53ef\u4ee5\u4ee5\u539f\u751f\u914d\u7f6e\u6587\u4ef6\u683c\u5f0f\u4fdd\u5b58\u914d\u7f6e\u3002<\/p>\n<p><!--more--><br \/>\n2\u3001\u67e5\u627e\u4e00\u4e2a\u914d\u7f6e\u8282\u70b9<\/p>\n<pre class=\"lang:default decode:true \">use Rex::Commands::Augeas;\n my $k = augeas exists =&gt; \"\/files\/etc\/hosts\/*\/ipaddr\", \"127.0.0.1\";<\/pre>\n<p>3\u3001\u589e\u52a0\u4e00\u4e2a\u914d\u7f6e\u9879\u76ee<\/p>\n<pre class=\"lang:default decode:true \"> augeas insert =&gt; \"\/files\/etc\/hosts\",\n           label =&gt; \"01\",\n           after =&gt; \"\/7\",\n           ipaddr =&gt; \"192.168.2.23\",\n           canonical =&gt; \"test\";<\/pre>\n<p>\u7ed3\u679c\uff1a<\/p>\n<pre class=\"lang:default decode:true\"> 192.168.1.1  tcentral localhost localhost.localdomain localhost4 localhost4.localdomain4\n::1         localhost localhost.localdomain localhost6 localhost6.localdomain6\n 192.168.1.1 tv_central\n 192.168.1.1 centralmysq\n 192.168.1.1 centralmemecache\n 192.168.1.1 memecache01\n 192.168.1.1 redis\n192.168.2.23    test<\/pre>\n<p>3\u3001\u5bfc\u51fa\u914d\u7f6e\u6587\u4ef6<\/p>\n<pre class=\"lang:default decode:true \"> augeas dump =&gt; \"\/files\/etc\/hosts\";<\/pre>\n<p>\u7ed3\u679c<\/p>\n<pre class=\"lang:default decode:true \"> \/files\/etc\/hosts\n\/files\/etc\/hosts\/1\n\/files\/etc\/hosts\/1\/ipaddr = \" 192.168.1.1\"\n\/files\/etc\/hosts\/1\/canonical = \"tv_central_platform01\"\n\/files\/etc\/hosts\/1\/alias[1] = \"localhost\"\n\/files\/etc\/hosts\/1\/alias[2] = \"localhost.localdomain\"\n\/files\/etc\/hosts\/1\/alias[3] = \"localhost4\"\n\/files\/etc\/hosts\/1\/alias[4] = \"localhost4.localdomain4\"\n\/files\/etc\/hosts\/2\n\/files\/etc\/hosts\/2\/ipaddr = \"::1\"\n\/files\/etc\/hosts\/2\/canonical = \"localhost\"\n\/files\/etc\/hosts\/2\/alias[1] = \"localhost.localdomain\"\n\/files\/etc\/hosts\/2\/alias[2] = \"localhost6\"\n\/files\/etc\/hosts\/2\/alias[3] = \"localhost6.localdomain6\"\n\/files\/etc\/hosts\/3\n\n<\/pre>\n<p>4\u3001\u4fee\u6539\u6587\u4ef6<\/p>\n<pre class=\"lang:default decode:true\"> augeas modify =&gt;\n    \"\/files\/etc\/ssh\/sshd_config\/PermitRootLogin\" =&gt; \"without-password\",\n    on_change =&gt; sub {\n       service ssh =&gt; \"restart\";\n    };<\/pre>\n","protected":false},"excerpt":{"rendered":"<p>1\u3001Augeas\u662f\u4ec0\u4e48? Augeas\u57fa\u672c\u4e0a\u5c31\u662f\u4e00\u4e2a\u914d\u7f6e\u7f16\u8f91\u5de5\u5177\u3002\u5b83\u4ee5\u4ed6\u4eec\u539f\u751f\u7684\u683c\u5f0f\u89e3\u6790\u914d\u7f6e\u6587\u4ef6\u5e76\u4e14\u5c06\u5b83\u4eec\u8f6c\u6362 [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[21,23],"tags":[29,40,44],"class_list":["post-832","post","type-post","status-publish","format-standard","hentry","category-perl","category-rex","tag-advent","tag-perl","tag-rex"],"_links":{"self":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/832","targetHints":{"allow":["GET"]}}],"collection":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcomments&post=832"}],"version-history":[{"count":0,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/832\/revisions"}],"wp:attachment":[{"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fmedia&parent=832"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcategories&post=832"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Ftags&post=832"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}