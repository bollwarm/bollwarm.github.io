{"id":162,"date":"2013-07-11T15:53:39","date_gmt":"2013-07-11T07:53:39","guid":{"rendered":"http:\/\/localhost\/?p=162"},"modified":"2013-07-11T15:53:39","modified_gmt":"2013-07-11T07:53:39","slug":"%e8%ae%a1%e7%ae%97%e5%86%9c%e5%8e%86%e7%9a%84%e5%87%bd%e6%95%b0%e6%b1%87%e7%bc%96%e5%8e%9f%e7%a0%81%ef%bc%883%ef%bc%89zz","status":"publish","type":"post","link":"http:\/\/ijz.me\/?p=162","title":{"rendered":"\u8ba1\u7b97\u519c\u5386\u7684\u51fd\u6570\u6c47\u7f16\u539f\u7801\uff083\uff09\/zz\/"},"content":{"rendered":"<p>;=============================<br \/>\n_GetLunarYearDays\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 proc\u00a0\u00a0\u00a0 dwYear:dword<br \/>\npushad<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 edx,dwYear<br \/>\ncmp\u00a0\u00a0\u00a0\u00a0 edx,2050<br \/>\nja\u00a0\u00a0\u00a0\u00a0\u00a0 toerr<br \/>\nsub\u00a0\u00a0\u00a0\u00a0 dx,1900<br \/>\njb\u00a0\u00a0\u00a0\u00a0\u00a0 toerr<\/p>\n<p><!--more--><br \/>\nmov\u00a0\u00a0\u00a0\u00a0 bx,LunarInfo[edx*2]<br \/>\n&amp;n103fbsp;\u00a0\u00a0 mov\u00a0\u00a0\u00a0\u00a0 ecx,12<br \/>\nxor\u00a0\u00a0\u00a0\u00a0 eax,eax<br \/>\nloc3:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 shl\u00a0\u00a0\u00a0\u00a0 bx,1<br \/>\nadc\u00a0\u00a0\u00a0\u00a0 eax,29<br \/>\nloop\u00a0\u00a0\u00a0 loc3<br \/>\nor\u00a0\u00a0\u00a0\u00a0\u00a0 bx,bx<br \/>\njz\u00a0\u00a0\u00a0\u00a0\u00a0 loc4<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 cl,dl<br \/>\nand\u00a0\u00a0\u00a0\u00a0 cl,7<br \/>\ninc\u00a0\u00a0\u00a0\u00a0 cl<br \/>\nshr\u00a0\u00a0\u00a0\u00a0 edx,3<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 dl,leapBigTab[edx]<br \/>\nshl\u00a0\u00a0\u00a0\u00a0 dl,cl<br \/>\nadc\u00a0\u00a0\u00a0\u00a0 eax,29<br \/>\nloc4:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 jmp\u00a0\u00a0\u00a0\u00a0 toRet<br \/>\ntoerr:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 mov\u00a0\u00a0\u00a0\u00a0 eax,12*30<br \/>\ntoRet:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 mov\u00a0\u00a0\u00a0\u00a0 [esp+1Ch],eax\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ;returnEAX<br \/>\npopad<br \/>\nret<br \/>\n_GetLunarYearDays\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 endp<br \/>\n;=============================<br \/>\n_GetLunarMonthDays\u00a0\u00a0\u00a0\u00a0\u00a0 proc\u00a0\u00a0\u00a0 dwYear:dword,dwMonth:dword<br \/>\npushad<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 edx,dwYear<br \/>\ncmp\u00a0\u00a0\u00a0\u00a0 edx,2050<br \/>\nja\u00a0\u00a0\u00a0\u00a0\u00a0 toerr<br \/>\n103f\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 sub\u00a0\u00a0\u00a0\u00a0 dx,1900<br \/>\njb\u00a0\u00a0\u00a0\u00a0\u00a0 toerr<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 ecx,dwMonth<br \/>\ncmp\u00a0\u00a0\u00a0\u00a0 ecx,12<br \/>\nja\u00a0\u00a0\u00a0\u00a0\u00a0 toerr<br \/>\ncmp\u00a0\u00a0\u00a0\u00a0 cl,1<br \/>\njb\u00a0\u00a0\u00a0\u00a0\u00a0 toerr<br \/>\nmovzx\u00a0\u00a0 ebx,LunarInfo[edx*2]<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 esi,ebx<br \/>\nxor\u00a0\u00a0\u00a0\u00a0 eax,eax<br \/>\nshl\u00a0\u00a0\u00a0\u00a0 bx,cl<br \/>\nadc\u00a0\u00a0\u00a0\u00a0 eax,29<br \/>\nand\u00a0\u00a0\u00a0\u00a0 esi,0Fh<br \/>\ncmp\u00a0\u00a0\u00a0\u00a0 esi,ecx<br \/>\njnz\u00a0\u00a0\u00a0\u00a0 toRet<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 cl,dl<br \/>\nand\u00a0\u00a0\u00a0\u00a0 cl,7<br \/>\ninc\u00a0\u00a0\u00a0\u00a0 cl<br \/>\nshr\u00a0\u00a0\u00a0\u00a0 edx,3<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 dl,leapBigTab[edx]<br \/>\nshl\u00a0\u00a0\u00a0\u00a0 dl,cl<br \/>\nadc\u00a0\u00a0\u00a0\u00a0 ah,29<br \/>\njmp\u00a0\u00a0\u00a0\u00a0 toRet<br \/>\ntoerr:\u00a0\u00a0\u00a0\u00a0\u00a0&amp;103fnbsp;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 mov\u00a0\u00a0\u00a0\u00a0 eax,30<br \/>\ntoRet:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 mov\u00a0\u00a0\u00a0\u00a0 [esp+1Ch],eax\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ;returnEAX<br \/>\npopad<br \/>\nret<br \/>\n_GetLunarMonthDays\u00a0\u00a0\u00a0\u00a0\u00a0 endp<br \/>\n;=====================================<br \/>\n_GetLunarData\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 proc\u00a0\u00a0\u00a0 _lpstLunarData:dword<br \/>\nassume esi:ptr LUNARDATA<br \/>\nlocal\u00a0\u00a0 AllDay:dword,ThisYear,ThisMonth,ThisDay,AllDays<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 eax,-1<br \/>\npushad<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 esi,_lpstLunarData<br \/>\nlea\u00a0\u00a0\u00a0\u00a0 edi,[esi].dwLunarYear<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 ecx,sizeof LUNARDATA-6<br \/>\ninc\u00a0\u00a0\u00a0\u00a0 eax<br \/>\ncld<br \/>\nrep\u00a0\u00a0\u00a0\u00a0 stosb<br \/>\nmovzx\u00a0\u00a0 edx,[esi].dwYear<br \/>\ncmp\u00a0\u00a0\u00a0\u00a0 edx,1901<br \/>\njb\u00a0\u00a0\u00a0\u00a0\u00a0 OverErr<br \/>\ncmp\u00a0\u00a0\u00a0\u00a0 edx,2050<br \/>\nja\u00a0\u00a0\u00a0\u00a0\u00a0 OverErr<br \/>\nmovzx\u00a0\u00a0 ebx,[esi].dwMonth<br \/>\ncmp\u00a0\u00a0\u00a0\u00a0 ebx,1<br \/>\njb\u00a0\u00a0\u00a0\u00a0\u00a0 OverErr<br \/>\ncmp\u00a0\u00a0\u00a0\u00a0 ebx,12<br \/>\n&amp;nbs103fp;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ja\u00a0\u00a0\u00a0\u00a0\u00a0 OverErr<br \/>\ninvoke\u00a0 _GetMonthDays,edx,ebx<br \/>\nmovzx\u00a0\u00a0 ecx,[esi].dwDay<br \/>\ncmp\u00a0\u00a0\u00a0\u00a0 ecx,1<br \/>\njb\u00a0\u00a0\u00a0\u00a0\u00a0 OverErr<br \/>\ncmp\u00a0\u00a0\u00a0\u00a0 ecx,31<br \/>\nja\u00a0\u00a0\u00a0\u00a0\u00a0 OverErr<br \/>\ninvoke\u00a0 _GetBetweenDays,edx,ebx,ecx,1901,1,1<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 AllDays,eax<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 ThisYear,1900<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 ThisMonth,11<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 ecx,eax<br \/>\nadd\u00a0\u00a0\u00a0\u00a0 cl,11<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 ThisDay,ecx<br \/>\ncmp\u00a0\u00a0\u00a0\u00a0 eax,19<br \/>\njb\u00a0\u00a0\u00a0\u00a0\u00a0 loc07<br \/>\nsub\u00a0\u00a0\u00a0\u00a0 eax,18<br \/>\ninc\u00a0\u00a0\u00a0\u00a0 ThisMonth<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 ThisDay,eax<br \/>\ncmp\u00a0\u00a0\u00a0\u00a0 eax,31<br \/>\njb\u00a0\u00a0\u00a0\u00a0\u00a0 loc07<br \/>\nsub\u00a0\u00a0\u00a0\u00a0 eax,31<br \/>\ninc\u00a0\u00a0\u00a0\u00a0 103fThisYear<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 ThisMonth,1<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 ThisDay,1<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 AllDay,eax<br \/>\nloc01:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 invoke\u00a0 _GetLunarYearDays,ThisYear<br \/>\ncmp\u00a0\u00a0\u00a0\u00a0 AllDay,eax<br \/>\njb\u00a0\u00a0\u00a0\u00a0\u00a0 loc02<br \/>\nsub\u00a0\u00a0\u00a0\u00a0 AllDay,eax<br \/>\ninc\u00a0\u00a0\u00a0\u00a0 ThisYear<br \/>\njmp\u00a0\u00a0\u00a0\u00a0 loc01<br \/>\nloc02:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 invoke\u00a0 _GetLunarMonthDays,ThisYear,ThisMonth<br \/>\nmovzx\u00a0\u00a0 edx,ah<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 ah,0<br \/>\ncmp\u00a0\u00a0\u00a0\u00a0 AllDay,eax<br \/>\njb\u00a0\u00a0\u00a0\u00a0\u00a0 loc06<br \/>\nsub\u00a0\u00a0\u00a0\u00a0 AllDay,eax<br \/>\ncmp\u00a0\u00a0\u00a0\u00a0 AllDay,edx<br \/>\njb\u00a0\u00a0\u00a0\u00a0\u00a0 loc05<br \/>\nsub\u00a0\u00a0\u00a0\u00a0 AllDay,edx<br \/>\nloc04:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 inc\u00a0\u00a0\u00a0\u00a0 ThisMonth<br \/>\njmp\u00a0\u00a0\u00a0\u00a0 loc02<br \/>\nloc05:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 mov\u00a0\u00a0\u00a0\u00a0 [esi].dbIsLeapMonth,1<br \/>\nloc06:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 mov\u00a0\u00a0\u00a0\u00a0 eax,AllDay<br \/>\nadd\u00a0\u00a0\u00a0\u00a0 ThisDay,eax<br \/>\nloc07:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0&amp;nbs103fp;\u00a0\u00a0 mov\u00a0\u00a0\u00a0\u00a0 eax,ThisYear<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 [esi].dwLunarYear,ax<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 eax,ThisMonth<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 [esi].dbLunarMonth,al<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 eax, dword ptr ThisDay<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 [esi].dbLunarDay,al<br \/>\nmovzx\u00a0\u00a0 edx,[esi].dwYear<br \/>\nmovzx\u00a0\u00a0 ebx,[esi].dwMonth<br \/>\nmovzx\u00a0\u00a0 ecx,[esi].dwDay<br \/>\ninvoke\u00a0 _GetWeekDay,edx,ebx,ecx<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 [esi].dbWeekDay,al<br \/>\ninvoke\u00a0 _GetHolDay,edx,ebx,ecx<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 [esi].noLunarHolDay,al<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 ecx,60<br \/>\nmovzx\u00a0\u00a0 eax,[esi].dwLunarYear<br \/>\nadd\u00a0\u00a0\u00a0\u00a0 eax,56<br \/>\ncdq<br \/>\ndiv\u00a0\u00a0\u00a0\u00a0 ecx<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 [esi].noLunarYear,dl<br \/>\nmovzx\u00a0\u00a0 eax,[esi].dwLunarYear<br \/>\nimul\u00a0\u00a0\u00a0 eax,12<br \/>\nmovzx\u00a0\u00a0 edx,[esi].dbLunarMonth<br \/>\nadd\u00a0\u00a0\u00a0\u00a0 eax,edx<br \/>\n103f\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 add\u00a0\u00a0\u00a0\u00a0 eax,13<br \/>\ncdq<br \/>\ndiv\u00a0\u00a0\u00a0\u00a0 ecx<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 [esi].noLunarMonth,dl<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 eax,AllDays<br \/>\nadd\u00a0\u00a0\u00a0\u00a0 eax,15<br \/>\ncdq<br \/>\ndiv\u00a0\u00a0\u00a0\u00a0 ecx<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 [esi].noLunarDay,dl<br \/>\nmov\u00a0\u00a0\u00a0\u00a0 dword ptr [esp+1Ch],0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ;returnEAX<br \/>\nOverErr:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 popad<br \/>\nret<br \/>\nassume\u00a0 esi:nothing<br \/>\n_GetLunarData\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 endp<\/p>\n","protected":false},"excerpt":{"rendered":"<p>;============================= _GetLunarYearDays\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0  [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[12],"tags":[52],"class_list":["post-162","post","type-post","status-publish","format-standard","hentry","category-program","tag-52"],"_links":{"self":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/162","targetHints":{"allow":["GET"]}}],"collection":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcomments&post=162"}],"version-history":[{"count":0,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/162\/revisions"}],"wp:attachment":[{"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fmedia&parent=162"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcategories&post=162"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Ftags&post=162"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}