{"id":688,"date":"2014-11-21T15:14:20","date_gmt":"2014-11-21T07:14:20","guid":{"rendered":"http:\/\/ijz.me\/?p=688"},"modified":"2014-11-21T15:14:20","modified_gmt":"2014-11-21T07:14:20","slug":"vsftp%e9%85%8d%e7%bd%ae%e8%99%9a%e6%8b%9f%e7%94%a8%e6%88%b7zz","status":"publish","type":"post","link":"http:\/\/ijz.me\/?p=688","title":{"rendered":"VSFTP\u914d\u7f6e\u865a\u62df\u7528\u6237\/zz\/"},"content":{"rendered":"<h1 class=\"postTitle\"><\/h1>\n<div id=\"cnblogs_post_body\">\n<p>\u00a0\u00a0\u00a0\u00a0 \u865a\u62df\u7528\u6237\u7684\u7279\u70b9\u662f\u53ea\u80fd\u8bbf\u95ee\u670d\u52a1\u5668\u4e3a\u5176\u63d0\u4f9b\u7684FTP\u670d\u52a1\uff0c\u800c\u4e0d\u80fd\u8bbf\u95ee\u7cfb\u7edf\u7684\u5176\u5b83\u8d44\u6e90\u3002\u6240\u4ee5\uff0c\u5982\u679c\u60f3\u8ba9\u7528\u6237\u5bf9FTP\u670d\u52a1\u5668\u7ad9\u5185\u5177\u6709\u5199\u6743\u9650\uff0c\u4f46\u53c8\u4e0d\u5141\u8bb8\u8bbf\u95ee\u7cfb\u7edf\u5176\u5b83\u8d44\u6e90\uff0c\u53ef\u4ee5\u4f7f\u7528\u865a\u62df\u7528\u6237\u6765\u63d0\u9ad8\u7cfb\u7edf\u7684\u5b89\u5168\u6027\u3002<\/p>\n<p>\u5728VSFTP\u4e2d\uff0c\u8ba4\u8bc1\u8fd9\u4e9b\u865a\u62df\u7528\u6237\u4f7f\u7528\u7684\u662f\u5355\u72ec\u7684\u53e3\u4ee4\u5e93\u6587\u4ef6\uff08pam_userdb\uff09\uff0c\u7531\u53ef\u63d2\u5165\u8ba4\u8bc1\u6a21\u5757\uff08PAM\uff09\u8ba4\u8bc1\u3002\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u66f4\u52a0\u5b89\u5168\uff0c\u5e76\u4e14\u914d\u7f6e\u66f4\u52a0\u7075\u6d3b\u3002<br \/>\n\u4e0b\u9762\u4ecb\u7ecd\u914d\u7f6e\u8fc7\u7a0b\u3002<br \/>\n<!--more--><br \/>\n1\uff0e\u751f\u6210\u865a\u62df\u7528\u6237\u53e3\u4ee4\u5e93\u6587\u4ef6\u3002\u4e3a\u4e86\u5efa\u7acb\u6b64\u53e3\u4ee4\u5e93\u6587\u4ef6\uff0c\u5148\u8981\u751f\u6210\u4e00\u4e2a\u6587\u672c\u6587\u4ef6\u3002\u8be5\u6587\u4ef6\u7684\u683c\u5f0f\u5982\u4e0b\uff0c\u5355\u6570\u884c\u4e3a\u7528\u6237\u540d\uff0c\u5076\u6570\u884c\u4e3a\u53e3\u4ee4\uff1a<\/p>\n<p>#vi account.txt<br \/>\nylg<br \/>\n1234<br \/>\nzhanghong<br \/>\n4321<br \/>\ngou<br \/>\n5678<\/p>\n<p>2\uff0e\u751f\u6210\u53e3\u4ee4\u5e93\u6587\u4ef6\uff0c\u5e76\u4fee\u6539\u5176\u6743\u9650\uff1a<\/p>\n<p>#db_load -T -t hash -f .\/account.txt \/etc\/vsftpd\/account.db<br \/>\n#chmod 600 \/etc\/vsftpd\/account.db<\/p>\n<p>3\uff0e\u65b0\u5efa\u4e00\u4e2a\u865a\u62df\u7528\u6237\u7684PAM\u6587\u4ef6\u3002\u52a0\u4e0a\u5982\u4e0b\u4e24\u884c\u5185\u5bb9\uff1a<\/p>\n<p>#vi \/etc\/pam.d\/vsftp.vu<br \/>\nauth required \/lib\/security\/pam_userdb.so db=\/etc\/vsftpd\/account<br \/>\naccount required \/lib\/security\/pam_userdb.so db=\/etc\/vsftpd\/account<\/p>\n<p>4\uff0e\u5efa\u7acb\u865a\u62df\u7528\u6237\uff0c\u8bbe\u7f6e\u8be5\u7528\u6237\u6240\u8981\u8bbf\u95ee\u7684\u76ee\u5f55\uff0c\u5e76\u8bbe\u7f6e\u865a\u62df\u7528\u6237\u8bbf\u95ee\u7684\u6743\u9650\uff1a<\/p>\n<p>#useradd -d \/home\/ftpsite virtual_user<br \/>\n#chmod 700 \/home\/ftpsite<\/p>\n<p>\u7ecf\u8fc7\u8be5\u6b65\u9aa4\u7684\u8bbe\u7f6e\uff0c\/home\/ftpsite\u5c31\u662fvirtual_user\u7528\u6237\u7684\u4e3b\u76ee\u5f55\uff0c\u8be5\u7528\u6237\u4e5f\u662fftpsite\u76ee\u5f55\u7684\u62e5\u6709\u8005\u3002\u9664root\u7528\u6237\u4e4b\u5916\uff0c\u53ea\u6709\u8be5\u7528\u6237\u5177\u6709\u5bf9\u8be5\u76ee\u5f55\u7684\u8bfb\u3001\u5199\u548c\u6267\u884c\u7684\u6743\u9650\u3002<br \/>\n5\uff0e\u7f16\u8f91\/etc\/vsftpd\/vsftpd.conf\u6587\u4ef6\uff0c\u4f7f\u5176\u6574\u4e2a\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\u6240\u793a\uff08\u53bb\u6389\u4e86\u6ce8\u91ca\u5185\u5bb9\uff09\uff1a<\/p>\n<p>anonymous_enable=NO<br \/>\nlocal_enable=YES<br \/>\nlocal_umask=022<br \/>\nxferlog_enable=YES<br \/>\nconnect_from_port_20=YES<br \/>\nxferlog_std_format=YES<br \/>\nlisten=YES<br \/>\nwrite_enable=YES<br \/>\nanon_upload_enable=YES<br \/>\nanon_mkdir_write_enable=YES<br \/>\nanon_other_write_enable=YES<br \/>\none_process_model=NO<br \/>\nchroot_local_user=YES<br \/>\nftpd_banner=Welcom to my FTP server.<br \/>\nanon_world_readable_only=NO<br \/>\nguest_enable=YES<br \/>\nguest_username=virtual_user<br \/>\npam_service_name=vsftp.vu<\/p>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0cguest_enable=YES\u8868\u793a\u542f\u7528\u865a\u62df\u7528\u6237\uff1bguest_username=virtual\u5219\u662f\u5c06\u865a\u62df\u7528\u6237\u6620\u5c04\u4e3a\u672c\u5730\u7528\u6237\uff0c\u8fd9\u6837\u865a\u62df \u7528\u6237\u767b\u5f55\u540e\u624d\u80fd\u8fdb\u5165\u672c\u5730\u7528\u6237virtual\u7684\u76ee\u5f55\/ftpsite\uff1bpam_service_name=vsftp.vu\u6307\u5b9aPAM\u7684\u914d\u7f6e\u6587\u4ef6\u4e3a vsftp.vu\u3002<\/p>\n<p>6\uff0e\u91cd\u65b0\u542f\u52a8VSFTP\uff1a<br \/>\n#service vsftpd restart<\/p>\n<p>7\uff0e\u4ee5\u865a\u62df\u7528\u6237gou\uff08Linux\u4e2d\u5e76\u65e0\u8be5\u8d26\u53f7\uff09\u8fdb\u884c\u6d4b\u8bd5\uff1a<\/p>\n<p># ftp 127.0.0.1<br \/>\nConnected to 127.0.0.1 (127.0.0.1).<br \/>\n220 Welcom to my FTP server.<br \/>\nName (127.0.0.1:root): gou<br \/>\n331 Please specify the password.<br \/>\nPassword:<br \/>\n230 Login successful. Have fun.<br \/>\nRemote system type is UNIX.<br \/>\nUsing binary mode to transfer files.<\/p>\n<p>\u5728\u865a\u62dfFTP\u670d\u52a1\u5668\u4e2d\uff0c\u4e5f\u53ef\u4ee5\u5bf9\u5404\u4e2a\u7528\u6237\u7684\u6743\u9650\u8fdb\u884c\u8bbe\u7f6e\u3002\u65b9\u6cd5\u662f\u5728\/etc\/vsftpd.conf\u6587\u4ef6\u4e2d\u6dfb\u52a0\u5982\u4e0b\u4e00\u884c\uff1a<br \/>\nuser_config_dir=\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55<\/p>\n<p>\u7136\u540e\u5728\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\u4e0b\u521b\u5efa\u76f8\u5e94\u7684\u7528\u6237\u914d\u7f6e\u6587\u4ef6\uff0c\u6bd4\u5982\u4e3a\u4e0a\u8ff0\u540d\u4e3agou\u7684\u7528\u6237\u521b\u5efa\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff08\u5047\u8bbe\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\u4e3a\/etc\/vsftpd_user_conf\uff09\uff1a<\/p>\n<p>#vi \/etc\/vsftpd_user_conf\/gou<br \/>\nwrite_enable=NO<br \/>\nanono_upload_enable=NO<\/p>\n<p>8.\u865a\u62df\u7528\u6237\u4e2a\u4eba\u76ee\u5f55\u8bbe\u7f6e<\/p>\n<p>\u5927\u5bb6\u53ef\u4ee5\u53d1\u73b0\uff0c\u65e0\u8bba\u662f\u54ea\u4e2a\u865a\u62df\u7528\u6237\uff0c\u767b\u5f55\u540e\u6240\u5728\u7684\u76ee\u5f55\u90fd\u662f\/home\/ftpsite\uff0c\u5373\u90fd\u662fguest\u7528\u6237\u7684\u81ea\u5bb6\u76ee\u5f55\u3002\u4e0b\u9762\uff0c\u4ecb\u7ecd\u5982\u4f55\u4e3a\u6bcf\u4e2a\u865a\u62df\u7528\u6237\u5efa\u7acb\u81ea\u5bb6\u76ee\u5f55\u3002<br \/>\n\u4e00\u79cd\u4f5c\u6cd5\u662f\u5728\u865a\u62df\u7528\u6237\u7684\u4e2a\u4eba\u914d\u7f6e\u6587\u4ef6\u4e2d\u4f7f\u7528local_root\u9009\u9879\u6307\u5b9a\u865a\u62df\u7528\u6237\u7684\u81ea\u5bb6\u76ee\u5f55\u3002\u4ee5gou\u4e3a\u4f8b\uff0c\u5728\u7b2c\u4e0a\u6b65\u7684\u57fa\u7840\u4e0a\uff0c\u9996\u5148\/etc\/vsftpd_user_conf\/gou\u6587\u4ef6\u4e2d\u52a0\u5165\uff1a<br \/>\nlocal_root=\/home\/ftpsite\/gou<\/p>\n<p>\/home\/ftpsite\u4e0b\u65b0\u5efagou\u76ee\u5f55\uff0c\u5e76\u5c06\u6743\u9650\u8bbe\u4e3avirtual_user\uff1a<br \/>\n9.\u6dfb\u52a0FTP\u7528\u6237\u7684\u6b65\u9aa4<\/p>\n<p>1.\u5728account.txt\u4e2d\u6dfb\u52a0\u7528\u6237\u540d\u548c\u5bc6\u7801<\/p>\n<p>2.\u8fd0\u884c\u5982\u4e0b\u547d\u4ee4,\u5c06\u7528\u6237\u540d\u548c\u5bc6\u7801\u6dfb\u52a0\u5230\u6570\u636e\u5e93\u4e2d<\/p>\n<p>db_load -T -t hash -f .\/account.txt \/etc\/vsftpd\/account.db<\/p>\n<p>3.\u5728\/home\/ftpsite\u4e2d\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6\u5939,\u4e0e\u7528\u6237\u660e\u76f8\u540c<\/p>\n<p>4.\u5728vsftpd_user_conf\u6587\u4ef6\u5939\u4e0b\u65b0\u5efa\u548c\u7528\u6237\u540d\u76f8\u540c\u7684\u6587\u4ef6,\u5e76\u5728\u5176\u4e2d\u52a0\u5165<br \/>\nlocal_root=\/home\/ftpsite\/\u7528\u6237\u540d<\/p>\n<\/div>\n","protected":false},"excerpt":{"rendered":"<p>\u00a0\u00a0\u00a0\u00a0 \u865a\u62df\u7528\u6237\u7684\u7279\u70b9\u662f\u53ea\u80fd\u8bbf\u95ee\u670d\u52a1\u5668\u4e3a\u5176\u63d0\u4f9b\u7684FTP\u670d\u52a1\uff0c\u800c\u4e0d\u80fd\u8bbf\u95ee\u7cfb\u7edf\u7684\u5176\u5b83\u8d44\u6e90\u3002\u6240\u4ee5\uff0c\u5982\u679c\u60f3\u8ba9\u7528\u6237\u5bf9F [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[7],"tags":[31],"class_list":["post-688","post","type-post","status-publish","format-standard","hentry","category-tools","tag-ftp"],"_links":{"self":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/688","targetHints":{"allow":["GET"]}}],"collection":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcomments&post=688"}],"version-history":[{"count":0,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/688\/revisions"}],"wp:attachment":[{"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fmedia&parent=688"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcategories&post=688"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Ftags&post=688"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}