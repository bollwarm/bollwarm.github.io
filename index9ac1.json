{"id":156,"date":"2013-07-11T15:43:49","date_gmt":"2013-07-11T07:43:49","guid":{"rendered":"http:\/\/localhost\/?p=156"},"modified":"2013-07-11T15:43:49","modified_gmt":"2013-07-11T07:43:49","slug":"%e7%bd%91%e9%a1%b5%e6%92%ad%e6%94%be%e5%99%a8%e5%8a%a8%e6%80%81%e6%98%be%e7%a4%ba%e6%ad%8c%e8%af%8d%e7%9a%84%e4%bb%a3%e7%a0%81","status":"publish","type":"post","link":"http:\/\/ijz.me\/?p=156","title":{"rendered":"\u7f51\u9875\u64ad\u653e\u5668\u52a8\u6001\u663e\u793a\u6b4c\u8bcd\u7684\u4ee3\u7801"},"content":{"rendered":"<p>\u8fd9\u662f\u7f51\u9875\u64ad\u653e\u5668\u52a8\u6001\u663e\u793a\u6b4c\u8bcd\u7684\u4ee3\u7801\uff08\u4fee\u6539\u81ea\u767e\u5ea6MP3\u8bd5\u542c\u64ad\u653e\u5668\u4ee3\u7801\uff09\uff0c\u50cf\u767e\u5ea6\u4e00\u6837\u5355\u66f2\u64ad\u653e\u6ca1\u6709\u4efb\u4f55\u95ee\u9898\uff0c\u4f46\u8fde\u64ad\u65f6\u6301\u7eed\u64ad\u653e10\u591a\u9996\u6b4c\u540eCPU\u5360\u7528\u5c31\u8d85\u8fc790%\u4e86\uff0c\u76f4\u5230\u6b7b\u673a<br \/>\n\u4ee5\u4e0b\u662f\u4ee3\u7801\uff1a<\/p>\n<div class=\"msgheader\">\n<div class=\"right\">[Copy to clipboard]<\/div>\n<p>CODE:<\/p>\n<\/div>\n<div class=\"msgborder\" id=\"code0\">function lrcInterface(pID,lrcID){<br \/>\nvar tmpOutput=null;<br \/>\nvar bdLRC=null;<br \/>\nvar count=null;<br \/>\nvar tmp=null;<br \/>\nvar lrcFileName=null;<br \/>\nvar lrcfile_xmlhttp=null;<br \/>\nvar tmpURL=null;<br \/>\nvar tmpStr=null;tmpOutput=document.getElementById(&#8216;followTd&#8217;);<br \/>\ncount=0;<br \/>\ntmpOutput.innerHTML=&#8221;<\/p>\n<p><span style=\"font-size: 12px; margin-left: 12px;\"> \u6b63\u5728\u52a0\u8f7d\u6b4c\u8bcd\u4fe1\u606f\uff0c\u8bf7\u60a8\u7a0d\u7b49\u7247\u523b&#8230;.&#8221;;<br \/>\ntmp=setInterval(getObject,200);<br \/>\nfunction getObject(){<br \/>\nbdLRC=new bdSyncLRC();<br \/>\nif(bdLRC!=null){<br \/>\nclearInterval(tmp);<\/span><\/p>\n<p>if(typeof(pID)==&#8221;string&#8221;){<br \/>\nbdLRC.playerObj=document.getElementById(pID);<br \/>\n}else{<br \/>\nif(typeof(pID)==&#8221;object&#8221;)bdLRC.playerObj=pID;<br \/>\n}<\/p>\n<p>lrcFileName=lrcID+&#8221;.lrc&#8221;;<br \/>\nbdLRC.lrcURL=&#8221;http:\/\/192.168.0.249\/music\/readlrc.asp?checked=&#8221;+lrcFileName;<br \/>\nbdLRC.lrcShower=&#8221;followTd&#8221;;<\/p>\n<p>lrcfile_xmlhttp=obj_newxmlhttp();<br \/>\ntmpURL=bdLRC.lrcURL;<br \/>\ntmpStr=&#8221;&#8221;;<br \/>\nlrcfile_xmlhttp.onreadystatechange=function(){<br \/>\nif(lrcfile_xmlhttp.readyState==4){<br \/>\ntmpStr=bytes2BSTR(lrcfile_xmlhttp.responseBody);<br \/>\nlrcfile_xmlhttp=null;<br \/>\nbdLRC.lrcContent=tmpStr;<br \/>\n}<br \/>\n}<br \/>\nlrcfile_xmlhttp.open(&#8220;POST&#8221;,tmpURL,true);<br \/>\nlrcfile_xmlhttp.send(null);<\/p>\n<p>bdLRC.begin();<br \/>\n}else{<br \/>\nif(count==25){<br \/>\nclearInterval(tmp);<br \/>\ntmpOutput.innerHTML=&#8221;<\/p>\n<p><span style=\"font-size: 12px; margin-left: 12px;\"> \u53ef\u80fd\u662f\u56e0\u4e3a\u7f51\u7edc\u7684\u539f\u56e0\uff0c\u7cfb\u7edf\u6ca1\u6709\u627e\u5230\u5408\u9002\u7684\u6b4c\u8bcd\u3002\u8bf7\u7a0d\u540e\u91cd\u8bd5&#8221;;<br \/>\n}else count++;<br \/>\n}<br \/>\n}<br \/>\n}<br \/>\nfunction bdSyncLRC(){<br \/>\nvar playerObj=null;<br \/>\nvar playerTypeStr=null;<br \/>\nvar lrcURL=null;<br \/>\nvar lrcShower=null;<br \/>\nvar lrcContent=null;<br \/>\nvar lrcObjArray=null;<br \/>\nlrcURL=&#8221;&#8221;;<br \/>\nlrcShower=&#8221;&#8221;;<br \/>\nlrcContent=&#8221;&#8221;;<br \/>\nlrcObjArray=new Array();<br \/>\nthis.preLRC=new Array();<br \/>\nthis.offsetTime=0;<br \/>\nthis.scrollMoveLen=20;<br \/>\n}<br \/>\nbdSyncLRC.prototype.getPlayer=function(){<br \/>\nif(typeof(document.getElementById(&#8220;this.playerObj&#8221;))==&#8217;object&#8217;){<br \/>\nreturn this.playerObj;<br \/>\n}else{<br \/>\nreturn null;<br \/>\n}<br \/>\n}<br \/>\nbdSyncLRC.prototype.getURL=function(){return this.lrcURL;};<br \/>\nbdSyncLRC.prototype.getOutput=function(){<br \/>\nif(this.lrcShower!=&#8221;&#8221;){<br \/>\nif(typeof(this.lrcShower)==&#8221;string&#8221;){<br \/>\nreturn document.getElementById(this.lrcShower);<br \/>\n}else{<br \/>\nif(typeof(this.lrcShower)==&#8221;object&#8221;)return this.lrcShower;<br \/>\n}<br \/>\n};<br \/>\nreturn null;<br \/>\n};<br \/>\nbdSyncLRC.prototype.multiLRC=function(lrcLine){<br \/>\nthisObj=this;<br \/>\ntmpVar=lrcLine.split(&#8220;]&#8221;);<br \/>\nif(tmpVar.length&gt;=2){<br \/>\nlrcText=tmpVar[tmpVar.length-1];<br \/>\nfor(j3=0;j3&lt;tmpVar.length-1;j3++){<br \/>\nlrcTime=tmpVar[j3]+&#8221;]&#8221;;<br \/>\nthisObj.preLRC.push(lrcTime+&#8221;&#8221;+lrcText);<br \/>\n}<br \/>\n}<br \/>\n}<br \/>\nbdSyncLRC.prototype.preSyncLRC=function(){<br \/>\nif(this.lrcContent==null||this.lrcContent==&#8221;&#8221;)return;<br \/>\nlrcLines=this.lrcContent.split(&#8220;n&#8221;);<br \/>\ntmpArr=new Array();<br \/>\nfor(i1=0;i1&lt;lrcLines.length;i1++)this.multiLRC(replaceStr(lrcLines[i1])); this.preLRC.sort(); var tmpVar=&#8221;aaa&#8221;; for(i2=this.preLRC.length-1;i2&gt;=0;i2&#8211;){<br \/>\nif(this.preLRC[i2]==tmpVar){<br \/>\ntmpVar=this.preLRC[i2];<br \/>\nthis.preLRC.splice(i2,1);<br \/>\n}else{<br \/>\ntmpVar=this.preLRC[i2];<br \/>\n}<br \/>\n}<br \/>\npreTime=0;<br \/>\nindexLRC=1;<br \/>\ntmpArr[0]=new LRCItem(0,&#8221;&#8221;);<br \/>\nfor(i3=0;i3&lt;this.preLRC.length;i3++){ if(this.preLRC[i3].length&gt;9){<br \/>\ntmpTime=getLyrcTime(this.preLRC[i3]);<br \/>\ntmpLrc=getLyrc(this.preLRC[i3]);<br \/>\nif(tmpTime&lt;preTime)continue; preTime=tmpTime; var tmpItem=new LRCItem(tmpTime,tmpLrc); tmpArr[indexLRC++]=tmpItem; } } var tmpItem=new LRCItem(3600,&#8221;Over&#8230;&#8221;); tmpArr[indexLRC]=tmpItem; if(tmpArr.length&gt;=1)this.lrcObjArray=tmpArr;<br \/>\n}<br \/>\nfunction replaceStr(tmpStr){return tmpStr.replace(\/^s*|s*$\/g,&#8221;&#8221;);};<br \/>\nfunction getLyrc(tmpStr){try{tmpArray=tmpStr.split(&#8220;]&#8221;);return tmpArray[tmpArray.length-1];}catch(e){};return&#8221;&#8221;;};<br \/>\nfunction getLyrcTime(tmpStr){try{tmpChar=tmpStr.split(&#8220;]&#8221;)[0].split(&#8220;[&#8220;)[1];tmpVar=tmpChar.split(&#8220;:&#8221;);if(tmpVar.length&lt;2)return 0;min=tmpVar[1].split(&#8220;.&#8221;)[0];tmpInt=parseInt(tmpVar[0])*60+parseFloat(min);if(!isNaN(tmpInt))return tmpInt;}catch(e){};return 0;}; function LRCItem(){varlrcTime=-1;var lrcContent=&#8221;&#8221;;if(arguments.length&gt;=2){this.lrcTime=arguments[0];this.lrcContent=arguments[1];};};<br \/>\nfunction obj_newxmlhttp(){<br \/>\n\/* Create a new XMLHttpRequest object to talk to the Web server *\/<br \/>\nvar xmlhttp = false;<br \/>\n\/*@cc_on @*\/<br \/>\n\/*@if (@_jscript_version &gt;= 5)<br \/>\ntry {<br \/>\nxmlhttp = new ActiveXObject(&#8220;Msxml2.XMLHTTP&#8221;);<br \/>\n} catch (e) {<br \/>\ntry {<br \/>\nxmlhttp = new ActiveXObject(&#8220;Microsoft.XMLHTTP&#8221;);<br \/>\n} catch (e2) {<br \/>\nxmlhttp = false;<br \/>\n}<br \/>\n}<br \/>\n@end @*\/<\/span><\/p>\n<p>if (!xmlhttp &amp;&amp; typeof XMLHttpRequest != &#8216;undefined&#8217;) {<br \/>\nxmlhttp = new XMLHttpRequest();<br \/>\n}<br \/>\nreturn xmlhttp;<br \/>\n}<br \/>\nbdSyncLRC.prototype.begin=function(){<br \/>\nthisObj=this;<br \/>\ntmpPlayerObj=thisObj.getPlayer();<br \/>\nvar tmpOutput=document.getElementById(&#8216;followTd&#8217;);<br \/>\nvar tmpI=setInterval(getlrc,100);<br \/>\nvar count1=0;<br \/>\nfunction getlrc(){<br \/>\nif(typeof(thisObj.lrcContent)!=&#8221;undefined&#8221;){<br \/>\nclearInterval(tmpI);<br \/>\nthisObj.preSyncLRC();<br \/>\nvar tmp,tmpArray;<br \/>\ntmpArray=thisObj.lrcObjArray;<br \/>\ntmp=&#8221;<br \/>\n&#8220;+&#8221;<br \/>\n&#8220;+&#8221;<br \/>\n&#8220;+&#8221;<br \/>\n&#8220;+&#8221;<br \/>\n&#8220;+&#8221;<br \/>\n&#8220;+&#8221;<br \/>\n&#8220;;<br \/>\nfor(i10=0;i10&lt;tmpArray.length;i10++)tmp+=&#8221;<span style=\"font-size: 12px; margin-left: 12px;\"><span style=\"color: #000000;\">&#8220;+replaceStr(tmpArray[i10].lrcContent)+&#8221;<\/span><\/span><br \/>\n&#8220;;<br \/>\nthisObj.getOutput().innerHTML=tmp;<br \/>\ngetPlayingTime(tmpPlayerObj,thisObj);<br \/>\n}else{<br \/>\nif(count1==50){<br \/>\nclearInterval(tmpI);<br \/>\ntmpOutput.innerHTML=&#8221;<\/p>\n<p><span style=\"font-size: 12px; margin-left: 12px;\"> \u53ef\u80fd\u662f\u56e0\u4e3a\u7f51\u7edc\u7684\u539f\u56e0\uff0c\u7cfb\u7edf\u6ca1\u6709\u627e\u5230\u5408\u9002\u7684\u6b4c\u8bcd\u3002\u8bf7\u7a0d\u540e\u91cd\u8bd5&#8221;;<br \/>\n}else count1++;<br \/>\n}<br \/>\n}<br \/>\n}<br \/>\nfunction getPlayingTime(playerObj,bdLRCObj){<br \/>\ntry{<br \/>\ntmpbdLRCObj=bdLRCObj;<br \/>\nvar tmpPlayerObj=playerObj;<br \/>\nif(typeof(tmpPlayerObj)==&#8221;string&#8221;)tmpPlayerObj=document.getElementById(tmpPlayerObj);<br \/>\nwindow.setTimeout(&#8220;getPlayingTime(tmpPlayerObj,tmpbdLRCObj)&#8221;,500);<br \/>\nbdsyncLyrc(tmpbdLRCObj);<br \/>\n}catch(e){<br \/>\ndocument.title=&#8221;getPlayingTime&#8230;&#8221;+e.toString();<br \/>\n}<br \/>\n}<br \/>\nvar preMatchLrcLine=-1;<br \/>\nfunction bdsyncLyrc(bdLRCObj){<br \/>\ntry{<br \/>\ntmpPlayer=bdLRCObj.getPlayer();<br \/>\nplayerStatus=tmpPlayer.GetPlayState();<br \/>\nif(tmpPlayer){<br \/>\nvar tmpLrcContent=null;<br \/>\nvar color=null;<br \/>\nvar lineCount=null;<br \/>\nvar perLineCount=null;<br \/>\nvar i4=null;<br \/>\ncurrentTime=tmpPlayer.GetPosition()\/1000;<br \/>\n\/\/ bdLRCObj.preSyncLRC();<br \/>\ntmpLrcs=bdLRCObj.lrcObjArray;<br \/>\ntmpScroll=bdLRCObj.getOutput();<br \/>\ntmpScrollId=bdLRCObj.getOutput();<br \/>\nperLength=bdLRCObj.scrollMoveLen;<br \/>\ntmpLrcContent=new Array(20);<br \/>\ncolor=new Array(21);<br \/>\nlineCount=new Array(tmpLrcs.length);<br \/>\nperLineCount=new Array(tmpLrcs.length);<br \/>\nfor(i4=0;i4&lt;tmpLrcs.length;i4++){<br \/>\nlineCount[i4]=Math.floor(tmpLrcs[i4].lrcContent.length\/67);<br \/>\nperLineCount[i4]=0;<br \/>\nfor(j1=0;j1&lt;i4;j1++){<br \/>\nperLineCount[i4]+=lineCount[j1];<br \/>\n}<br \/>\n}<br \/>\n\/\/window.upid6.innerHTML=perLineCount;<br \/>\ncolor[0]=&#8221;#000000&#8243;;color[1]=&#8221;#0d0500&#8243;;color[2]=&#8221;#1a0a00&#8243;;color[3]=&#8221;#270f00&#8243;;color[4]=&#8221;#341400&#8243;;color[5]=&#8221;#411900&#8243;;color[6]=&#8221;#4e1e00&#8243;;color[7]=&#8221;#5b2300&#8243;;color[8]=&#8221;#682800&#8243;;color[9]=&#8221;#752d00&#8243;;color[10]=&#8221;#823200&#8243;;color[11]=&#8221;#8f3700&#8243;;color[12]=&#8221;#9c3c00&#8243;;color[13]=&#8221;#a94100&#8243;;color[14]=&#8221;#b64600&#8243;;color[15]=&#8221;#c34b00&#8243;;color[16]=&#8221;#d05000&#8243;;color[17]=&#8221;#dd5500&#8243;;color[18]=&#8221;#ea5a00&#8243;;color[19]=&#8221;#f75f00&#8243;;color[20]=&#8221;#ff5a00&#8243;;<br \/>\nfor(i5=0;i5&lt;20;i5++)tmpLrcContent[i5]=&#8221;<br \/>\n&#8220;+&#8221;<br \/>\n&#8220;+&#8221;<br \/>\n&#8220;+&#8221;<br \/>\n&#8220;+&#8221;<br \/>\n&#8220;+&#8221;<br \/>\n&#8220;+&#8221;<br \/>\n&#8220;;<br \/>\nvar tmpMatchLrcLine=0;<br \/>\nfor(j2=0;j2&lt;tmpLrcs.length;j2++){<br \/>\nnowLrc=tmpLrcs[j2];<br \/>\nnextLrc=tmpLrcs[(j2&lt;tmpLrcs.length-1)?j2+1:j2];<br \/>\nnowTime=nowLrc.lrcTime+bdLRCObj.offsetTime;<br \/>\nnextTime=nextLrc.lrcTime+bdLRCObj.offsetTime;<br \/>\nif(nowTime&lt;=currentTime&amp;\u00a4tTime&lt;nextTime){<br \/>\ntmpMatchLrcLine=j2;<br \/>\nfor(i6=0;i6&lt;20;i6++){<br \/>\ntmpLrcContent[i6]+=&#8221;<span style=\"font-size: 12px; margin-left: 12px;\"><span><span style=\"text-decoration: underline;\">&#8220;+replaceStr(tmpLrcs[j2].lrcContent)+&#8221;<\/span><\/span><\/span><br \/>\n&#8220;;<br \/>\n}<br \/>\nwindow.upid6.innerHTML=&#8221;<span>&#8220;+replaceStr(tmpLrcs[j2].lrcContent)+&#8221;<\/span>&#8220;;<br \/>\nj2+=1;<br \/>\ntmpInt=tmpLrcs.length-j2;<br \/>\nfor(;j2&lt;tmpLrcs.length;j2++){<br \/>\nfor(i7=0;i7&lt;20;i7++){<br \/>\ntmpLrcContent[i7]+=&#8221;<span style=\"font-size: 12px; margin-left: 12px;\"><span style=\"color: #000000;\">&#8220;+replaceStr(tmpLrcs[j2].lrcContent)+&#8221;<\/span><\/span><br \/>\n&#8220;;<br \/>\n}<br \/>\n}<br \/>\nif(tmpInt&lt;8){<br \/>\nfor(j2=0;j2&lt;=8-tmpInt;j2++){<br \/>\nfor(i8=0;i8&lt;20;i8++){<br \/>\ntmpLrcContent[i8]+=&#8221;<br \/>\n&#8220;;<br \/>\n}<br \/>\n}<br \/>\n}<br \/>\nbreak;<br \/>\n}else{<br \/>\n\/\/window.upid6.innerHTML=preMatchLrcLine;<br \/>\nif(j2==preMatchLrcLine){<br \/>\nfor(i9=0;i9&lt;20;i9++)tmpLrcContent[i9]+=&#8221;<span style=\"font-size: 12px; margin-left: 12px;\"><span>&#8220;+replaceStr(tmpLrcs[j2].lrcContent)+&#8221;<\/span><\/span><br \/>\n&#8220;;<br \/>\n} else {<br \/>\nfor(i0=0;i0&lt;20;i0++)tmpLrcContent[i0]+=&#8221;<span style=\"font-size: 12px; margin-left: 12px;\"><span style=\"color: #000000;\">&#8220;+replaceStr(tmpLrcs[j2].lrcContent)+&#8221;<\/span><\/span><br \/>\n&#8220;;<br \/>\n}<br \/>\n}<br \/>\n}<br \/>\nif(preMatchLrcLine!=tmpMatchLrcLine){<br \/>\nif(Math.abs(tmpMatchLrcLine-preMatchLrcLine)&gt;1){<br \/>\ntmpScroll.innerHTML=tmpLrcContent[19];<br \/>\ntmpScrollId.scrollTop=(tmpMatchLrcLine+perLineCount[tmpMatchLrcLine]+1)*perLength;<br \/>\n\/\/ tmpScrollId.scrollTop=(tmpMatchLrcLine+perLineCount[tmpMatchLrcLine]+1)*perLength;<br \/>\n} else {<br \/>\nvar count2=0;<br \/>\nfunction scrollAdd(){<br \/>\ntmpScroll.innerHTML=tmpLrcContent[2*count2];<br \/>\ntmpScrollId.scrollTop+=2*(1+lineCount[preMatchLrcLine]);<br \/>\ncount2++;<br \/>\nif(count2==10)clearInterval(loaderInterval);<br \/>\n}<br \/>\nvar loaderInterval=setInterval(scrollAdd,25);<br \/>\n}<br \/>\n}<br \/>\npreMatchLrcLine=tmpMatchLrcLine;<br \/>\n}<br \/>\n}catch(e){<br \/>\ndocument.title=&#8221;bdsyncLyrc=&#8221;+e.toString();<br \/>\n}<br \/>\n};<\/span><\/p>\n<\/div>\n","protected":false},"excerpt":{"rendered":"<p>\u8fd9\u662f\u7f51\u9875\u64ad\u653e\u5668\u52a8\u6001\u663e\u793a\u6b4c\u8bcd\u7684\u4ee3\u7801\uff08\u4fee\u6539\u81ea\u767e\u5ea6MP3\u8bd5\u542c\u64ad\u653e\u5668\u4ee3\u7801\uff09\uff0c\u50cf\u767e\u5ea6\u4e00\u6837\u5355\u66f2\u64ad\u653e\u6ca1\u6709\u4efb\u4f55\u95ee\u9898\uff0c\u4f46\u8fde\u64ad\u65f6\u6301 [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[12],"tags":[],"class_list":["post-156","post","type-post","status-publish","format-standard","hentry","category-program"],"_links":{"self":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/156","targetHints":{"allow":["GET"]}}],"collection":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcomments&post=156"}],"version-history":[{"count":0,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/156\/revisions"}],"wp:attachment":[{"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fmedia&parent=156"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcategories&post=156"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Ftags&post=156"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}