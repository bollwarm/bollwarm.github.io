{"id":60,"date":"2013-07-11T15:49:45","date_gmt":"2013-07-11T07:49:45","guid":{"rendered":"http:\/\/localhost\/?p=60"},"modified":"2013-07-11T15:49:45","modified_gmt":"2013-07-11T07:49:45","slug":"sqlserver%e3%80%81access%e5%92%8cexcel%e7%9a%84%e6%95%b0%e6%8d%ae%e8%bd%ac%e6%8d%a2zz","status":"publish","type":"post","link":"http:\/\/ijz.me\/?p=60","title":{"rendered":"SQLSERVER\u3001ACCESS\u548cEXCEL\u7684\u6570\u636e\u8f6c\u6362\/zz\/"},"content":{"rendered":"<p>\u719f\u6089SQL SERVER 2000\u7684\u6570\u636e\u5e93\u7ba1\u7406\u5458\u90fd\u77e5\u9053\uff0c\u5176DTS\u53ef\u4ee5\u8fdb\u884c\u6570\u636e\u7684\u5bfc\u5165\u5bfc\u51fa\uff0c\u5176\u5b9e\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528Transact-SQL\u8bed\u53e5\u8fdb\u884c\u5bfc\u5165\u5bfc\u51fa\u64cd\u4f5c\u3002\u5728Transact-SQL\u8bed\u53e5\u4e2d\uff0c\u6211\u4eec\u4e3b\u8981\u4f7f\u7528OpenDataSource\u51fd\u6570\u3001OPENROWSET \u51fd\u6570\uff0c\u5173\u4e8e\u51fd\u6570\u7684\u8be6\u7ec6\u8bf4\u660e\uff0c\u8bf7\u53c2\u8003SQL\u8054\u673a\u5e2e\u52a9\u3002\u5229\u7528\u4e0b\u8ff0\u65b9\u6cd5\uff0c\u53ef\u4ee5\u5341\u5206\u5bb9\u6613\u5730\u5b9e\u73b0SQL SERVER\u3001ACCESS\u3001EXCEL\u6570\u636e\u8f6c\u6362\uff0c\u8be6\u7ec6\u8bf4\u660e\u5982\u4e0b\uff1a<\/p>\n<p>\u4e00\u3001\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 SQL SERVER \u548cACCESS\u7684\u6570\u636e\u5bfc\u5165\u5bfc\u51fa<\/p>\n<p>Transact-SQL\u8bed\u53e5\u8fdb\u884c\u5bfc\u5165\u5bfc\u51fa\uff1a<\/p>\n<p>1.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u5728SQL SERVER\u91cc\u67e5\u8be2access\u6570\u636e:<\/p>\n<p>&#8212; ======================================================<\/p>\n<p>SELECT *<\/p>\n<p>FROM OpenDataSource( &#8216;Microsoft.Jet.OLEDB.4.0&#8217;,<\/p>\n<p>&#8216;Data Source=&#8221;c:DB.mdb&#8221;;User ID=Admin;Password=&#8217;)&#8230;\u8868\u540d<\/p>\n<p>&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-<\/p>\n<p>2.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u5c06access\u5bfc\u5165SQL server<\/p>\n<p>&#8212; ======================================================<\/p>\n<p>\u5728SQL SERVER \u91cc\u8fd0\u884c:<\/p>\n<p>SELECT *<\/p>\n<p>INTO newtable<\/p>\n<p>FROM OPENDATASOURCE (&#8216;Microsoft.Jet.OLEDB.4.0&#8217;,<\/p>\n<p>&#8216;D103fata Source=&#8221;c:DB.mdb&#8221;;User ID=Admin;Password=&#8217; )&#8230;\u8868\u540d<\/p>\n<p>&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-<\/p>\n<p>3.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u5c06SQL SERVER\u8868\u91cc\u7684\u6570\u636e\u63d2\u5165\u5230Access\u8868\u4e2d<\/p>\n<p>&#8212; ======================================================<\/p>\n<p>\u5728SQL SERVER \u91cc\u8fd0\u884c\uff1a<\/p>\n<p>insert into OpenDataSource( &#8216;Microsoft.Jet.OLEDB.4.0&#8217;,<\/p>\n<p>&#8216;Data Source=&#8221; c:DB.mdb&#8221;;User ID=Admin;Password=&#8217;)&#8230;\u8868\u540d<\/p>\n<p>(\u5217\u540d1,\u5217\u540d2)<\/p>\n<p>select \u5217\u540d1,\u5217\u540d2\u00a0\u00a0 from\u00a0\u00a0 sql\u8868<\/p>\n<p>\u5b9e\u4f8b\uff1a<\/p>\n<p>insert into\u00a0\u00a0 OPENROWSET(&#8216;Microsoft.Jet.OLEDB.4.0&#8217;,<\/p>\n<p>&#8216;C:db.mdb&#8217;;&#8217;admin&#8217;;&#8221;, Test)<\/p>\n<p>select id,name from Test<\/p>\n<p>INSERT INTO OPENROWSET(&#8216;Microsoft.Jet.OLEDB.4.0&#8217;, &#8216;c:trade.mdb&#8217;; &#8216;admin&#8217;; &#8221;, \u8868\u540d)<\/p>\n<p>SELECT *<\/p>\n<p>FROM sqltablename<\/p>\n<p>&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-<\/p>\n<p>\u4e8c\u3001\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 SQL SERVER \u548cEXCEL\u7684\u6570\u636e\u5bfc\u5165\u5bfc\u51fa<\/p>\n<p>1\u3001\u5728SQL SERVER\u91cc\u67e5\u8be2Excel\u6570\u636e:<\/p>\n<p>&#8212; ======================================================<\/p>\n<p>SELECT *<\/p>\n<p>FROM OpenDataSource( &#8216;Microsoft.Jet.OLEDB.4.0&#8217;,<\/p>\n<p>&#8216;Data Source=&#8221;c:book1.xls&#8221;;User ID=Admin;Password=;Extended properties=Excel 5.0&#8217;)&#8230;[Sheet1$]<\/p>\n<p>\u4e0b\u9762\u662f\u4e2a\u67e5\u8be2\u7684\u793a\u4f8b\uff0c\u5b83\u901a\u8fc7\u7528\u4e8e Jet \u7684 OLE DB \u63d0\u4f9b\u7a0b\u5e8f\u67e5\u8be2 Excel \u7535\u5b50\u8868\u683c\u3002<\/p>\n<p>SELECT *<br \/>\nFROM OpenDataSource ( &#8216;Microsoft.Jet.OLEDB.4.0&#8217;,<br \/>\n&#8216;Data Source=&#8221;c:Financeaccount.xls&#8221;;User ID=Admin;Password=;Extended properties=Excel 5.0&#8217;)&#8230;xactions<br \/>\n&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-<\/p>\n<p>2\u3001\u5c06Excel\u7684\u6570\u636e\u5bfc\u5165SQL server :<\/p>\n<p>&#8212; ======================================================<\/p>\n<p>SELECT * into newtable<\/p>\n<p>FROM OpenDataSource( &#8216;Microsoft.Jet.OLEDB.4.0&#8217;,<\/p>\n<p>&#8216;Data Source=&#8221;c:book1.xls&#8221;;User ID=Admin;Password=;Extended properties=Excel 5.0&#8217;)&#8230;[Sheet1$]<\/p>\n<p>\u5b9e\u4f8b:<\/p>\n<p>SELECT * into newtable<\/p>\n<p>FROM OpenDataSource( &#8216;Microsoft.Jet.OLEDB.4.0&#8217;,<\/p>\n<p>&#8216;Data Source=&#8221;c:Financeaccount.xls&#8221;;User ID=Admin;Password=;Extended properties=Excel 5.0&#8217;)&#8230;xactions<\/p>\n<p>&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-<\/p>\n<p>3\u3001\u5c06SQL SERVER\u4e2d\u67e5\u8be2\u5230\u7684\u6570\u636e\u5bfc\u6210\u4e00\u4e2aExcel\u6587\u4ef6<\/p>\n<p>&#8212; ======================================================<\/p>\n<p>T-SQL\u4ee3\u7801\uff1a<\/p>\n<p>EXEC master..xp_cmdshell &#8216;bcp \u5e93\u540d.dbo.\u8868\u540dout c:Temp.xls -c -q -S&#8221;servername&#8221; -U&#8221;sa&#8221; -P&#8221;&#8221;&#8216;<\/p>\n<p>\u53c2\u6570\uff1aS \u662fSQL\u670d\u52a1\u5668\u540d\uff1bU\u662f\u7528\u6237\uff1bP\u662f\u5bc6\u7801<\/p>\n<p>\u8bf4\u660e\uff1a\u8fd8\u53ef\u4ee5\u5bfc\u51fa\u6587\u672c\u6587\u4ef6\u7b49\u591a\u79cd\u683c\u5f0f<\/p>\n<p>\u5b9e\u4f8b:EXEC master..xp_cmdshell &#8216;bcp saletesttmp.dbo.CusAccount out c:temp1.xls -c -q -S&#8221;pmserver&#8221; -U&#8221;sa&#8221; -P&#8221;sa&#8221;&#8216;<\/p>\n<p>EXEC master..xp_cmdshell &#8216;bcp &#8220;SELECT au_fname, au_lname FROM pubs..authors ORDER BY au_lname&#8221; queryout C: authors.xls -c -Sservername -Usa -Ppassword&#8217;<\/p>\n<p>\u5728VB6\u4e2d\u5e94\u7528ADO\u5bfc\u51faEXCEL\u6587\u4ef6\u4ee3\u7801\uff1a<\/p>\n<p>Dim cn\u00a0\u00a0 As New ADODB.Connection<\/p>\n<p>cn.open &#8220;Driver={SQL Server};Server=WEBSVR;DataBase=WebMis;UID=sa;WD=123;&#8221;<\/p>\n<p>cn.execute &#8220;master..xp_cmdshell &#8216;bcp &#8220;SELECT col1, col2 FROM \u5e93\u540d.dbo.\u8868\u540d&#8221; queryout E:DT.xls -c -Sservername -Usa -Ppassword'&#8221;<\/p>\n<p>&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-<\/p>\n<p>103f<\/p>\n<p>4\u3001\u5728SQL SERVER\u91cc\u5f80Excel\u63d2\u5165\u6570\u636e:<\/p>\n<p>&#8212; ======================================================<\/p>\n<p>insert into OpenDataSource( &#8216;Microsoft.Jet.OLEDB.4.0&#8217;,<\/p>\n<p>&#8216;Data Source=&#8221;c:Temp.xls&#8221;;User ID=Admin;Password=;Extended properties=Excel 5.0&#8217;)&#8230;table1 (A1,A2,A3) values (1,2,3)<\/p>\n<p>T-SQL\u4ee3\u7801\uff1a<\/p>\n<p>INSERT INTO<\/p>\n<p>OPENDATASOURCE(&#8216;Microsoft.JET.OLEDB.4.0&#8217;,<\/p>\n<p>&#8216;Extended Properties=Excel 8.0;Data source=C:traininginventur.xls&#8217;)&#8230;[Filiale1$]<\/p>\n<p>(bestand, produkt) VALUES (20, &#8216;Test&#8217;)<\/p>\n","protected":false},"excerpt":{"rendered":"<p>\u719f\u6089SQL SERVER 2000\u7684\u6570\u636e\u5e93\u7ba1\u7406\u5458\u90fd\u77e5\u9053\uff0c\u5176DTS\u53ef\u4ee5\u8fdb\u884c\u6570\u636e\u7684\u5bfc\u5165\u5bfc\u51fa\uff0c\u5176\u5b9e\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528T [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[8],"tags":[],"class_list":["post-60","post","type-post","status-publish","format-standard","hentry","category-database"],"_links":{"self":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/60","targetHints":{"allow":["GET"]}}],"collection":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcomments&post=60"}],"version-history":[{"count":0,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/60\/revisions"}],"wp:attachment":[{"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fmedia&parent=60"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcategories&post=60"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Ftags&post=60"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}