{"id":119,"date":"2013-07-11T17:34:26","date_gmt":"2013-07-11T09:34:26","guid":{"rendered":"http:\/\/localhost\/?p=119"},"modified":"2013-07-11T17:34:26","modified_gmt":"2013-07-11T09:34:26","slug":"%e5%bc%ba%e5%a4%a7%e7%9a%84%e8%bd%bb%e9%87%8f%e7%ba%a7%e7%bd%91%e7%bb%9c%e5%85%a5%e4%be%b5%e6%a3%80%e6%b5%8b%e7%b3%bb%e7%bb%9fsnortzz","status":"publish","type":"post","link":"http:\/\/ijz.me\/?p=119","title":{"rendered":"\u5f3a\u5927\u7684\u8f7b\u91cf\u7ea7\u7f51\u7edc\u5165\u4fb5\u68c0\u6d4b\u7cfb\u7edfSNORT\/zz\/"},"content":{"rendered":"<p>1.\u7b80\u4ecb<\/p>\n<p>\u5728\u7f51\u7edc\u65e5\u76ca\u666e\u53ca\u7684\u4eca\u5929\uff0c\u7f51\u7edc\u5b89\u5168\u53d8\u7684\u8d8a\u6765\u8d8a\u91cd\u8981\uff0c\u4f5c\u4e3a\u7f51\u7edc\u5b89\u5168\u7684\u4e00\u4e2a\u91cd\u8981\u7ec4\u6210\u90e8\u5206\u7f51\u7edc\u5165\u4fb5\u68c0\u6d4b \u7cfb\u7edf(Network Intrusion Detection System\uff0cNIDS)\u4e5f\u8d8a\u6765\u8d8a\u663e\u793a\u51fa\u5176\u91cd\u8981\u6027\u3002NIDS\u7528\u6765\u76d1\u89c6\u7f51\u7edc\u6570\u636e\u6d41\u52a8\u60c5\u51b5\uff0c\u5f53\u5165\u4fb5\u53d1\u751f\u65f6\u80fd\u591f\u63d0\u4f9b\u62a5\u8b66\u3002\u73b0\u5728\u5df2\u7ecf\u51fa\u73b0\u4e86\u5f88\u591a\u5546\u4e1a\u7684NIDS\uff0c\u4f46 \u662f\u5b83\u4eec\u5927\u591a\u6bd4\u8f83\u590d\u6742\uff0c\u6bd4\u8f83\u96be\u4ee5\u638c\u63e1\uff0c\u800c\u4e14\u6bd4\u8f83\u6602\u8d35\uff0c\u6bd4\u8f83\u5c0f\u7684\u516c\u53f8\u65e0\u6cd5\u627f\u53d7\u3002\u672c\u6587\u5c06\u4ecb\u7ecd\u4e00\u4e2a\u51fa\u8272\u7684\u514d\u8d39NIDS\u7cfb\u7edf&#8212;snort\uff0c\u5b83\u57fa\u4e8eGPL\uff0c\u4f5c\u8005\u662f Martin Roesch\u3002\u6700\u65b0\u7248\u672c\u662f1.70\u7248\u3002\u672c\u6587\u5c06\u4ecb\u7ecdsnort\u7684\u6280\u672f\u7279\u70b9\u53ca\u5982\u4f55\u4f7f\u7528snort\u4f5c\u4e3aNIDS\u3002<\/p>\n<p><!--more--><\/p>\n<p>2.SNORT\u7684\u7279\u70b9<\/p>\n<p>snort \u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u8f7b\u91cf\u7ea7\u7684\u7f51\u7edc\u5165\u4fb5\u68c0\u6d4b\u7cfb\u7edf\u3002\u5b83\u5177\u6709\u5b9e\u65f6\u6570\u636e\u6d41\u91cf\u5206\u6790\u548c\u65e5\u5fd7IP\u7f51\u7edc\u6570\u636e\u5305\u7684\u80fd\u529b\uff0c\u80fd\u591f\u8fdb\u884c\u534f\u8bae\u5206\u6790\uff0c\u5bf9\u5185\u5bb9\u8fdb\u884c\u641c\u7d22\/\u5339\u914d\u3002\u5b83\u80fd\u591f\u68c0\u6d4b\u5404\u79cd\u4e0d \u540c\u7684\u653b\u51fb\u65b9\u5f0f\uff0c\u5bf9\u653b\u51fb\u8fdb\u884c\u5b9e\u65f6\u62a5\u8b66\u3002\u6b64\u5916\uff0csnort\u5177\u6709\u5f88\u597d\u7684\u6269\u5c55\u6027\u548c\u53ef\u79fb\u690d\u6027\u3002\u8fd8\u6709\uff0c\u8fd9\u4e2a\u8f6f\u4ef6\u9075\u5faa\u901a\u7528\u516c\u5171\u8bb8\u53ef\u8bc1GPL\uff0c\u6240\u4ee5\u53ea\u8981\u9075\u5b88GPL\u4efb\u4f55\u7ec4\u7ec7 \u548c\u4e2a\u4eba\u90fd\u53ef\u4ee5\u81ea\u7531\u4f7f\u7528\u3002<\/p>\n<p>1).snort\u662f\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u5165\u4fb5\u68c0\u6d4b\u7cfb\u7edf<br \/>\nsnort\u867d\u7136\u529f\u80fd\u5f3a\u5927\uff0c\u4f46\u662f\u5176\u4ee3\u7801\u6781\u4e3a\u7b80\u6d01\u3001\u77ed\u5c0f\uff0c\u5176\u6e90\u4ee3\u7801\u538b\u7f29\u5305\u53ea\u6709\u5927\u7ea6110KB\u3002<br \/>\n103f<br \/>\n2).snort\u7684\u53ef\u79fb\u690d\u6027\u5f88\u597d<br \/>\nsnort\u7684\u8de8\u5e73\u53f0\u6027\u80fd\u6781\u4f73\uff0c\u76ee\u524d\u5df2\u7ecf\u652f\u6301Linux,Solaris,BSD,IRIX,HP-UX,WinY2K\u7b49\u7cfb\u7edf\u3002<\/p>\n<p>3)\u3002snort\u7684\u529f\u80fd\u975e\u5e38\u5f3a\u5927<br \/>\nsnort \u5177\u6709\u5b9e\u65f6\u6d41\u91cf\u5206\u6790\u548c\u65e5\u5fd7IP\u7f51\u7edc\u6570\u636e\u5305\u7684\u80fd\u529b\u3002\u80fd\u591f\u5feb\u901f\u5730\u68c0\u6d4b\u7f51\u7edc\u653b\u51fb\uff0c\u53ca\u65f6\u5730\u53d1\u51fa\u62a5\u8b66\u3002snort\u7684\u62a5\u8b66\u673a\u5236\u5f88\u4e30\u5bcc,\u4f8b\u5982\uff1asyslog\u3001\u7528\u6237\u6307\u5b9a\u7684\u6587 \u4ef6\u3001\u4e00\u4e2aUNIX\u5957\u63a5\u5b57\uff0c\u8fd8\u6709\u4f7f\u7528SAMBA\u534f\u8bae\u5411Windows\u5ba2\u6237\u7a0b\u5e8f\u53d1\u51faWinPopup\u6d88\u606f\u3002\u5229\u7528XML\u63d2\u4ef6\uff0csnort\u53ef\u4ee5\u4f7f\u7528SNML(\u7b80\u5355 \u7f51\u7edc\u6807\u8bb0\u8bed\u8a00\uff0csimple network markup language)\u628a\u65e5\u5fd7\u5b58\u653e\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8005\u9002\u65f6\u62a5\u8b66\u3002<\/p>\n<p>snort\u80fd\u591f \u8fdb\u884c\u534f\u8bae\u5206\u6790\uff0c\u5185\u5bb9\u7684\u641c\u7d22\/\u5339\u914d\u3002\u73b0\u5728snort\u80fd\u591f\u5206\u6790\u7684\u534f\u8bae\u6709TCP\u3001UDP\u548cICMP\u3002\u5c06\u6765\uff0c\u53ef\u80fd\u63d0\u4f9b\u5bf9ARP\u3001ICRP\u3001GRE\u3001OSPF\u3001 RIP\u3001IPX\u7b49\u534f\u8bae\u7684\u652f\u6301\u3002\u5b83\u80fd\u591f\u68c0\u6d4b\u591a\u79cd\u65b9\u5f0f\u7684\u653b\u51fb\u548c\u63a2\u6d4b\uff0c\u4f8b\u5982\uff1a\u7f13\u51b2\u533a\u6ea2\u51fa\u3001\u79d8\u5bc6\u7aef\u53e3\u626b\u63cf\u3001CGI\u653b\u51fb\u3001SMB\u63a2\u6d4b\u3001\u63a2\u6d4b\u64cd\u4f5c\u7cfb\u7edf\u6307\u7eb9\u7279\u5f81\u7684\u4f01\u56fe\u7b49 \u7b49\u3002<\/p>\n<p>snort\u7684\u65e5\u5fd7\u683c\u5f0f\u65e2\u53ef\u4ee5\u662ftcpdump\u5f0f\u7684\u4e8c\u8fdb\u5236\u683c\u5f0f\uff0c\u4e5f\u53ef\u4ee5\u89e3\u7801\u6210ASCII\u5b57\u7b26\u5f62\u5f0f\uff0c\u66f4\u52a0\u4fbf\u4e8e\u7528\u6237\u5c24\u5176\u662f\u65b0\u624b\u68c0\u67e5\u3002\u4f7f \u7528\u6570\u636e\u5e93\u8f93\u51fa\u63d2\u4ef6\uff0csnort\u53ef\u4ee5\u628a\u65e5\u5fd7\u8bb0\u5165\u6570\u636e\u5e93\uff0c\u5f53\u524d\u652f\u6301\u7684\u6570\u636e\u5e93\u5305\u62ec\uff1aPostgresql\u3001MySQL\u3001\u4efb\u4f55unixODBC\u6570\u636e\u5e93,\u8fd8\u6709 Oracle(\u5bf9Oracle\u7684\u652f\u6301\u76ee\u524d\u5904\u4e8e\u6d4b\u8bd5\u9636\u6bb5)\u3002<\/p>\n<p>\u4f7f\u7528TCP\u6d41\u63d2\u4ef6(tcpstream)\uff0csnort\u53ef\u4ee5\u5bf9TCP\u5305\u8fdb\u884c\u91cd \u7ec4\u3002snort\u80fd\u591f\u5bf9IP\u5305\u7684\u5185\u5bb9\u8fdb\u884c\u5339\u914d\uff0c\u4f46\u662f\u5bf9\u4e8eTCP\u653b\u51fb\uff0c\u5982\u679c\u653b\u51fb\u8005\u4f7f\u7528\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u6bcf\u6b21\u53d1\u9001\u53ea\u6709\u4e00\u4e2a\u5b57\u8282\u7684TCP\u5305\uff0c\u5b8c\u5168\u53ef\u4ee5\u907f\u5f00snort\u7684\u6a21 \u5f0f\u5339\u914d\u3002\u800c\u88ab\u653b\u51fb\u7684\u4e3b\u673a\u7684TCP\u534f\u8bae\u6808\u4f1a\u91cd\u7ec4\u8fd9\u4e9b\u6570\u636e\uff0c\u5c06\u5176\u9001\u7ed9\u5728\u76ee\u6807\u7aef\u53e3\u4e0a\u76d1\u542c\u7684\u8fdb\u7a0b\uff0c\u4ece\u800c\u4f7f\u653b\u51fb\u5305\u9003\u8fc7snort\u7684\u76d1\u89c6\u3002\u4f7f\u7528TCP\u6d41\u63d2\u4ef6\uff0c\u53ef\u4ee5\u5bf9 TCP\u5305\u8fdb\u884c\u7f13\u51b2\uff0c\u7136\u540e\u8fdb\u884c\u5339\u914d\uff0c\u4f7fsnort\u5177\u5907\u4e86\u5bf9\u4ed8\u4e0a\u9762\u8fd9\u79cd\u653b\u51fb\u7684\u80fd\u529b\u3002<\/p>\n<p>\u4f7f\u7528spade(Statistical Packet Anomaly Detection Engine)\u63d2\u4ef6\uff0csnort\u80fd\u591f\u62a5\u544a\u975e\u6b63\u5e38\u7684\u53ef\u7591\u5305\uff0c\u4ece\u800c\u5bf9\u7aef\u53e3\u626b\u63cf\u8fdb\u884c\u6709\u6548\u7684\u68c0\u6d4b\u3002<\/p>\n<p>snort\u8fd8\u6709\u5f88\u5f3a\u7684\u7cfb\u7edf\u9632\u62a4\u80fd\u529b\u3002\u4f7f\u7528FlexResp\u529f\u80fd\uff0csnort\u80fd\u591f\u4e3b\u52a8\u65ad\u5f00\u6076\u610f\u8fde\u63a5\u3002<\/p>\n<p>4).\u6269\u5c55\u6027\u80fd\u8f83\u597d\uff0c\u5bf9\u4e8e\u65b0\u7684\u653b\u51fb\u5a01\u80c1\u53cd\u5e94\u8fc5\u901f<br \/>\n\u4f5c\u4e3a\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u7f51\u7edc\u5165\u4fb5\u68c0\u6d4b\u7cfb\u7edf\uff0csnort\u6709\u8db3\u591f\u7684\u6269\u5c55\u80fd\u529b\u3002\u5b83\u4f7f\u7528\u4e00\u79cd\u7b80\u5355\u7684\u89c4\u5219\u63cf\u8ff0\u8bed\u8a00\u3002\u6700\u57fa\u672c\u7684\u89c4\u5219\u53ea\u662f\u5305\u542b\u56db\u4e2a\u4e2a\u57df\uff1a\u5904\u7406\u52a8\u4f5c\u3001\u534f\u8bae\u3001\u65b9\u5411\u3001\u6ce8\u610f\u7684\u7aef\u53e3\u3002\u4f8b\u5982\uff1a<br \/>\nlog tcp any any -&gt; 10.1.1.0\/24 79 \u3002\u8fd8\u6709\u4e00\u4e9b\u529f\u80fd\u9009\u9879\u53ef\u4ee5\u7ec4\u5408\u4f7f\u7528\uff0c\u5b9e\u73b0\u66f4\u4e3a\u590d\u6742\u7684\u529f\u80fd\u3002\u5c06\u6709\u4e00\u7bc7\u5355\u72ec\u7684\u6587\u7ae0\u8ba8\u8bba\u5982\u4f55\u5199snort\u89c4\u5219\u3002\u7528\u6237\u53ef\u4ee5\u4ecehttp: \/\/www.snort.org\u5f97\u5230\u5176\u89c4\u5219\u96c6\u3002\u53e6\u5916\uff0c\u8457\u540d\u7684\u9ed1\u5ba2Max Vision\u5728http:\/\/www.whitehats.com\u63d0\u4f9b\u5728\u7ebf\u7684\u6280\u672f\u652f\u6301\u3002<\/p>\n<p>snort\u652f\u6301\u63d2\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528\u5177\u6709\u7279\u5b9a\u529f\u80fd\u7684\u62a5\u544a\u3001\u68c0\u6d4b\u5b50\u7cfb\u7edf\u63d2\u4ef6\u5bf9\u5176\u529f\u80fd\u8fdb\u884c\u6269\u5c55\u3002snort\u5f53\u524d\u652f\u6301\u7684\u63d2\u4ef6\u5305\u62ec\uff1a\u6570\u636e\u5e93\u65e5\u5fd7\u8f93\u51fa\u63d2\u4ef6\u3001\u788e\u6570\u636e\u5305\u68c0\u6d4b\u63d2\u4ef6\u3001\u7aef\u53e3\u626b\u63cf\u68c0\u6d4b\u63d2\u4ef6\u3001HTTP URI normalization\u63d2\u4ef6\u3001XML\u63d2\u4ef6\u7b49\u3002<\/p>\n<p>snort\u7684\u89c4\u5219\u8bed\u8a00\u975e\u5e38\u7b80\u5355\uff0c\u80fd\u591f\u5bf9\u65b0\u7684\u7f51\u7edc\u653b\u51fb\u505a\u51fa\u5f88\u5feb\u7684\u53cd\u5e94\u3002\u53d1\u73b0\u65b0\u7684\u653b\u51fb\u540e\uff0c\u53ef\u4ee5\u5f88\u5feb\u6839\u636eBugtraq\u90ae\u4ef6\u5217\u8868\uff0c\u627e\u51fa\u7279\u5f81\u7801\uff0c\u5199\u51fa\u68c0\u6d4b\u89c4\u5219\u3002\u56e0\u4e3a\u5176\u89c4\u5219\u8bed\u8a00\u7b80\u5355\uff0c\u6240\u4ee5\u5f88\u5bb9\u6613\u4e0a\u624b\uff0c\u8282\u7701\u4eba\u5458\u7684\u57f9\u8bad\u8d39\u7528\u3002<\/p>\n<p>5).\u9075\u5faa\u516c\u5171\u901a\u7528\u8bb8\u53ef\u8bc1GPL<br \/>\nsnort\u9075\u5faaGPL\uff0c\u6240\u4ee5\u4efb\u4f55\u4f01\u4e1a\u3001\u4e2a\u4eba\u3001\u7ec4\u7ec7\u90fd\u53ef\u4ee5\u514d\u8d39\u4f7f\u7528\u5b83\u4f5c\u4e3a\u81ea\u5df1\u7684NIDS\u3002<\/p>\n<p>3.\u5b89\u88c5<\/p>\n<p>3.1.\u5982\u4f55\u83b7\u5f97snort<br \/>\n\u53ef\u4ee5\u4ecesnort\u7684\u7ad9\u70b9http:\/\/www.snort.org\u83b7\u5f97\u5176\u6e90\u4ee3\u7801\u6216\u8005RPM\u5305\u3002\u4f7f\u7528\u6e90\u4ee3\u7801\u5b89\u88c5snort\u9700\u8981libpcap\u5e93\uff0c\u53ef\u4ee5\u4eceftp:\/\/ftp.ee.l103fbl.gov\u4e0b\u8f7d\uff0c<\/p>\n<p>3.2.\u5b89\u88c5snort<\/p>\n<p>3.2.1.RPM\u5305\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u8fdb\u884c\u5b89\u88c5\uff1a<br \/>\nbash#rpm -ihv &#8211;nodeps snort-1.7-1.i386.rpm<\/p>\n<p>3.2.2.\u6e90\u4ee3\u7801\uff1a<\/p>\n<p>1).\u89e3\u538blibpcap\u5305\uff1a<br \/>\nbash#uncompress libpcap.tar.Z<br \/>\nbash#tar xvf libpcap.tar<br \/>\n2).\u7f16\u8bd1libpcap\u5e93\uff1a<br \/>\nbash#.\/configure<br \/>\nbash#make<br \/>\n3).\u89e3\u538bsnort-1.7.0.tar.gz<br \/>\nbash#tar zxvf snort-1.7.0.tar.gz<br \/>\n4).\u8fdb\u5165\u5230\u5176\u6240\u5728\u76ee\u5f55\uff0c\u7f16\u8bd1snort:<br \/>\nbash# .\/configure &#8211;with-libpcap-includes=\/path\/to\/your\/libcap\/headers<br \/>\nbash# make<br \/>\nbash# make install<br \/>\n5). configure\u811a\u672c\u8fd8\u6709\u4e00\u4e9b\u9009\u9879\uff1a&#8211;enable-smbalerts\u7f16\u8bd1SMB\u62a5\u8b66\u4ee3\u7801\uff1b&#8211;enable-flexresp\u7f16\u8bd1 Flexible Response\u4ee3\u7801\uff1b&#8211;with-mysql=DIR\u652f\u6301mysql\u6570\u636e\u5e93\uff1b&#8211;with-postgresql=DIR\u652f\u6301postsql\u6570\u636e\u5e93\uff1b &#8211;with-odbc=DIR\u652f\u6301ODBC\u6570\u636e\u5e93\uff1b&#8211;enable-openssl\u652f\u6301SSL\u3002\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u5b9e\u9645\u60c5\u51b5\u9009\u62e9\u8fd9\u4e9b\u9009\u9879\u3002<\/p>\n<p>4.\u4f7f\u7528<br \/>\n\u73b0 \u5728\uff0csnort\u5df2\u7ecf\u5b89\u88c5\u5b8c\u6210\u3002\u6211\u4eec\u5c06\u5728\u8fd9\u4e00\u8282\u8ba8\u8bba\u5982\u4f55\u4f7f\u7528snort\u3002\u4f5c\u4e3a\u4e00\u4e2a\u7f51\u7edc\u5165\u4fb5\u68c0\u6d4b\u7684\u8f6f\u4ef6\uff0csnort\u6709\u4e09\u79cd\u7528\u9014\uff1a\u6570\u636e\u5305\u55c5\u63a2\u5668(packet sniffer)\u3001\u6570\u636e\u5305\u5206\u6790\u5668(packet analyser)\u4ee5\u53ca\u7f51\u7edc\u5165\u4fb5\u68c0\u6d4b\u7cfb\u7edf\u3002\u8ba9\u6211\u4eec\u4ece\u6700\u7b80\u5355\u7684\u547d\u4ee4\u5f00\u59cb\uff0c\u8f93\u5165\u4e00\u4e2a\u7b80\u5355\u7684\u547d\u4ee4\u5217\u51fa\u6240\u6709\u7684\u547d\u4ee4\u884c\u5f00\u5173\u3002<\/p>\n<p>bash# snort -?<br \/>\n-*&gt; Snort! &lt;*-<br \/>\nVersion 1.7<br \/>\nBy Martin Roesch (roesch@clark.net, www.snort.org)<br \/>\nUSAGE: snort [-options]<br \/>\nOptions:<br \/>\n-A \u8bbe\u7f6e\u62a5\u8b66\u6a21\u5f0f\uff1afast\u3001full\u3001none(\u53ea\u662f\u4f7f\u7528\u62a5\u8b66\u6587\u4ef6)\u3001<br \/>\nunsock(\u4f7f\u7528UNIX\u5957\u63a5\u5b57\u8bb0\u5165\u65e5\u5fd7\uff0c\u51fa\u4e8e\u6d4b\u8bd5\u9636\u6bb5)<br \/>\n-a \u663e\u793aARP(Address Resolution Protocol,\u5730\u5740\u89e3\u6790<br \/>\n\u534f\u8bae)\u5305<br \/>\n-b \u65e5\u5fd7\u6587\u4ef6\u4f7f\u7528tcpdump\u683c\u5f0f(\u66f4\u5feb)<br \/>\n-c \u4f7f\u7528\u89c4\u5219\u6587\u4ef6rules<br \/>\n-C \u53ea\u4f7f\u7528\u5b57\u7b26\u65b9\u5f0f\u6253\u5370\u8d1f\u8f7d\u4fe1\u606f(\u4e0d\u4f7f\u7528hex\u65b9\u5f0f)<br \/>\n-d \u590d\u5236\u5e94\u7528\u5c42<br \/>\n-D \u5728\u540e\u53f0\u8fd0\u884csnort(\u7cbe\u7075\u72b6\u6001)<br \/>\n-e \u663e\u793a\u7b2c\u4e8c\u5c42(\u6570\u636e\u94fe\u8def\u5c42)\u5305\u5934\u4fe1\u606f<br \/>\n-F Read BPF filters from file<br \/>\n-g \u521d\u59cb\u5316\u5b8c\u6210\u540e\uff0c\u4f7fsnort\u7684gid\u4e3agname<br \/>\n-h Home\u7f51\u7edc\u4e3ahn<br \/>\n-i \u5728\u63a5\u53e3if\u4e0a\u76d1\u542c<br \/>\n-I \u628a\u754c\u9762\u540d\u52a0\u5165\u5230\u62a5\u8b66\u8f93\u51fa\u754c\u9762\u3002<br \/>\n-l \u8bbe\u7f6e\u76ee\u5f55ld\u4e3a\u65e5\u5fd7\u76ee\u5f55<br \/>\n-M \u628aSMB\u6d88\u606f\u53d1\u9001\u5230\u6587\u4ef6wrkst\u5217\u51fa\u7684\u5de5\u4f5c\u7ad9\u4e2d<br \/>\n(Requires smbclient to be in PATH)<br \/>\n-n \u6536\u5230cnt\u4e2a\u5305\u540e\u9000\u51fa<br \/>\n-N \u5173\u95ed\u65e5\u5fd7\u529f\u80fd(\u8b66\u62a5\u529f\u80fd\u4ecd\u7136\u6709\u6548)<br \/>\n-o \u628a\u89c4\u5219\u6d4b\u8bd5\u987a\u5e8f\u4fee\u6539\u4e3a\uff1aPass|Alert|Log<br \/>\n-O \u6253\u4e71\u88ab\u65e5\u5fd7\u7684IP\u5730\u5740<br \/>\n-p \u5173\u95ed\u6df7\u6742\u55c5\u63a2\u6a21\u5f0f<br \/>\n-P \u8bbe\u7f6e\u590d\u5236\u7684\u5305\u7684\u957f\u5ea6\u4e3asnaplen(\u9ed8\u8ba4: 1514)<br \/>\n-q \u5b89\u9759\u6a21\u5f0f\u3002\u4e0d\u8f93\u51fabanner\u548c\u72b6\u6001\u62a5\u544a\u3002<br \/>\n-r \u8bfb\u53d6\u5e76\u5904\u7406tcpdump\u6587\u4ef6tf(\u56de\u653e\u529f\u80fd)<br \/>\n-s \u628a\u6240\u6709\u8b66\u544a\u4fe1\u606f\u8bb0\u5165syslog<br \/>\n-S \u8bbe\u7f6e\u89c4\u5219\u6587\u4ef6\u4e2d\u7684n\u7684\u503c\u7b49\u4e8ev\u7684\u503c<br \/>\n-t<br \/>\n\u521d\u59cb\u5316\u5b8c\u6210\u540eChroot\u5230dir\u76ee\u5f55<br \/>\n-u \u521d\u59cb\u5316\u5b8c\u6210\u540e\uff0c\u628asnort\u7684uid\u8bbe\u7f6e\u4e3auname<br \/>\n-v \u8bbe\u7f6e\u5197\u4f59\u6a21\u5f0f<br \/>\n-V \u663e\u793a\u7248\u672c\u53f7<br \/>\n-X \u4ece\u94fe\u8def\u5c42\u5f00\u59cb\u590d\u5236\u5305\u7684\u6570\u636e<br \/>\n-? \u663e\u793a\u5e2e\u52a9\u4fe1\u606f<br \/>\n&lt;\u5305\u8fc7\u6ee4\u9009\u9879&gt;\u57fa\u4e8eBPF,\u53ef\u53c2\u8003TCPDump<\/p>\n<p>4.1.\u4f5c\u4e3a\u55c5\u63a2\u5668<br \/>\n\u6240\u8c13\u7684\u55c5\u63a2\u5668\u6a21\u5f0f\u5c31\u662fsnort\u4ece\u7f51\u7edc\u4e0a\u8bfb\u51fa\u6570\u636e\u5305\u7136\u540e\u663e\u793a\u5728\u4f60\u7684\u63a7\u5236\u53f0\u4e0a\u3002\u9996\u5148\uff0c\u6211\u4eec\u4ece\u6700\u57fa\u672c\u7684\u7528\u6cd5\u5165\u624b\u3002<\/p>\n","protected":false},"excerpt":{"rendered":"<p>1.\u7b80\u4ecb \u5728\u7f51\u7edc\u65e5\u76ca\u666e\u53ca\u7684\u4eca\u5929\uff0c\u7f51\u7edc\u5b89\u5168\u53d8\u7684\u8d8a\u6765\u8d8a\u91cd\u8981\uff0c\u4f5c\u4e3a\u7f51\u7edc\u5b89\u5168\u7684\u4e00\u4e2a\u91cd\u8981\u7ec4\u6210\u90e8\u5206\u7f51\u7edc\u5165\u4fb5\u68c0\u6d4b \u7cfb\u7edf(Ne [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[6,7],"tags":[],"class_list":["post-119","post","type-post","status-publish","format-standard","hentry","category-6","category-tools"],"_links":{"self":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/119","targetHints":{"allow":["GET"]}}],"collection":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcomments&post=119"}],"version-history":[{"count":0,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/119\/revisions"}],"wp:attachment":[{"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fmedia&parent=119"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcategories&post=119"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Ftags&post=119"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}