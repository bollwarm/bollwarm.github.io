{"id":49,"date":"2013-11-30T00:00:00","date_gmt":"2013-11-29T16:00:00","guid":{"rendered":"http:\/\/ijz.me\/?p=49"},"modified":"2013-11-30T00:00:00","modified_gmt":"2013-11-29T16:00:00","slug":"php-curl%e7%9a%84%e4%bd%bf%e7%94%a8","status":"publish","type":"post","link":"http:\/\/ijz.me\/?p=49","title":{"rendered":"php curl\u7684\u4f7f\u7528"},"content":{"rendered":"<p>\u5728PHP\u5f00\u53d1\u4e2d\uff0c\u6709\u65f6\u5019\u9700\u8981\u5728\u5185 \u90e8\u7f51\u4e2d\u8fdb\u884c\u5f00\u53d1\u3002\u5bf9\u4e8e\u6570\u636e\u6536\u96c6\u9879\u76ee\uff0c\u6709\u65f6\u5019\u670d\u52a1\u5668\u9700\u8981\u8fde\u63a5Internet\u7f51\u7edc\u6765\u83b7\u53d6Internet\u7f51\u7edc\u4e0a\u7684\u4fe1\u606f\u3002\u4f46\u662f\uff0c\u5982\u679c\u516c\u53f8\u662f\u901a\u8fc7\u9632\u706b\u5899\u4e0a\u7f51\uff0c\u4e00 \u822c\u7684file_get_post_content\u51fd\u6570\u5c31\u4e0d\u884c\u4e86\u3002\u5f53\u7136\uff0c\u901a\u8fc7\u4e00\u4e9bsocket\u64cd\u4f5c\uff0c\u76f4\u63a5\u5411proxy\u5199http\u8bf7\u6c42\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u4f46\u662f\u6bd4\u8f83\u9ebb\u70e6\u3002\u672c\u6587\u8ba8 \u8bba\u7528CURL\u5e93\u7684\u7b80\u5355\u4ee3\u7406\u5b9e\u73b0\u3002<\/p>\n<p><!--more--><br \/>\n1. CURL\u5e93\u7684\u5b89\u88c5<br \/>\n\u67e5Google\u53ef\u4ee5\u53d1\u73b0\u5f88\u591a\u5173\u4e8eCURL\u5e93\u5b89\u88c5\u7684\u6587\u6863\uff0c\u4f46\u5b9e\u9645\u4e0a\uff0c\u4e00\u822c\u7684Linux Installation\u90fd\u5305\u542b\u4e86CURL\u5e93\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7&lt;? phpinfo() ?&gt;\u68c0\u67e5php\u7f16\u8bd1\u53c2\u6570\u6765\u83b7\u53d6\u662f\u5426\u5b89\u88c5CURL\u5e93\u7684\u4fe1\u606f\u3002<br \/>\n\u5982\u4e0b\u6240\u793a\uff1a<br \/>\n<em>.\/configure&#8217; &#8216;&#8211;host=i386-redhat-linux&#8217; &#8216;&#8211;build=i386-redhat-linux&#8217; &#8216;&#8211;target=i386-redhat-linux-gnu&#8217; &#8216;&#8211;program-prefix=&#8217; &#8216;&#8211;prefix=\/usr&#8217; &#8216;&#8211;exec-prefix=\/usr&#8217; &#8216;&#8211;bindir=\/usr\/bin&#8217; &#8216;&#8211;sbindir=\/usr\/sbin&#8217; &#8216;&#8211;sysconfdir=\/etc&#8217; &#8216;&#8211;datadir=\/usr\/share&#8217; &#8216;&#8211;includedir=\/usr\/include&#8217; &#8216;&#8211;libdir=\/usr\/lib&#8217; &#8216;&#8211;libexecdir=\/usr\/libexec&#8217; &#8216;&#8211;localstatedir=\/var&#8217; &#8216;&#8211;sharedstatedir=\/usr\/com&#8217; &#8216;&#8211;mandir=\/usr\/share\/man&#8217; &#8216;&#8211;infodir=\/usr\/share\/info&#8217; &#8216;&#8211;cache-file=..\/config.cache&#8217; &#8216;&#8211;with-config-file-path=\/etc&#8217; &#8216;&#8211;with-config-file-scan-dir=\/etc\/php.d&#8217; &#8216;&#8211;enable-force-cgi-redirect&#8217; &#8216;&#8211;disable-debug&#8217; &#8216;&#8211;enable-pic&#8217; &#8216;&#8211;disable-rpath&#8217; &#8216;&#8211;enable-inline-optimization&#8217; &#8216;&#8211;with-bz2&#8217; &#8216;&#8211;with-db4=\/usr&#8217; &#8216;<strong>&#8211;with-curl<\/strong>&#8216; &#8216;&#8211;with-exec-dir=\/usr\/bin&#8217; &#8216;&#8211;with-freetype-dir=\/usr&#8217; &#8216;&#8211;with-png-dir=\/usr&#8217; &#8216;&#8211;with-gd&#8217; &#8216;&#8211;enable-gd-native-ttf&#8217; &#8216;&#8211;without-gdbm&#8217; &#8216;&#8211;with-gettext&#8217; &#8216;&#8211;with-ncurses&#8217; &#8216;&#8211;with-gmp&#8217; &#8216;&#8211;with-iconv103f&#8217; &#8216;&#8211;with-jpeg-dir=\/usr&#8217; &#8216;&#8211;with-openssl&#8217; &#8216;&#8211;with-png&#8217; &#8216;&#8211;with-pspell&#8217; &#8216;&#8211;with-regex=system&#8217; &#8216;&#8211;with-xml&#8217; &#8216;&#8211;with-expat-dir=\/usr&#8217; &#8216;&#8211;with-dom=shared,\/usr&#8217; &#8216;&#8211;with-dom-xslt=\/usr&#8217; &#8216;&#8211;with-dom-exslt=\/usr&#8217; &#8216;&#8211;with-xmlrpc=shared&#8217; &#8216;&#8211;with-pcre-regex=\/usr&#8217; &#8216;&#8211;with-zlib&#8217; &#8216;&#8211;with-layout=GNU&#8217; &#8216;&#8211;enable-bcmath&#8217; &#8216;&#8211;enable-exif&#8217; &#8216;&#8211;enable-ftp&#8217; &#8216;&#8211;enable-magic-quotes&#8217; &#8216;&#8211;enable-safe-mode&#8217; &#8216;&#8211;enable-sockets&#8217; &#8216;&#8211;enable-sysvsem&#8217; &#8216;&#8211;enable-sysvshm&#8217; &#8216;&#8211;enable-track-vars&#8217; &#8216;&#8211;enable-trans-sid&#8217; &#8216;&#8211;enable-yp&#8217; &#8216;&#8211;enable-wddx&#8217; &#8216;&#8211;with-pear=\/usr\/share\/pear&#8217; &#8216;&#8211;with-imap=shared&#8217; &#8216;&#8211;with-imap-ssl&#8217; &#8216;&#8211;with-kerberos&#8217; &#8216;&#8211;with-ldap=shared&#8217; &#8216;&#8211;with-mysql=shared,\/usr&#8217; &#8216;&#8211;with-pgsql=shared&#8217; &#8216;&#8211;with-snmp=shared,\/usr&#8217; &#8216;&#8211;with-snmp=shared&#8217; &#8216;&#8211;enable-ucd-snmp-hack&#8217; &#8216;&#8211;with-unixODBC=shared,\/usr&#8217; &#8216;&#8211;enable-memory-limit&#8217; &#8216;&#8211;enable-bcmath&#8217; &#8216;&#8211;enable-shmop&#8217; &#8216;&#8211;enable-calendar&#8217; &#8216;&#8211;enable-dbx&#8217; &#8216;&#8211;enable-dio&#8217; &#8216;&#8211;enable-mcal&#8217; &#8216;&#8211;enable-mbstring&#8217; &#8216;&#8211;enable-mbstr-enc-trans&#8217; &#8216;&#8211;enable-mbregex&#8217; &#8216;&#8211;with-apxs2=\/usr\/sbin\/apxs&#8217;<\/em><\/p>\n<p>2. \u4f7f\u7528CURL\u5e93\u8bbf\u95ee\u4ee3\u7406\u670d\u52a1\u5668<br \/>\n&lt;?<br \/>\nfunction curl_string ($url,$user_agent,$proxy){<\/p>\n<p>$ch = curl_init();<br \/>\ncurl_setopt ($ch, CURLOPT_PROXY, $proxy);<br \/>\ncurl_setopt ($ch, CURLOPT_URL, $url);<br \/>\ncurl_setopt ($ch, CURLOPT_USERAGENT, $user_agent);<br \/>\ncurl_setopt ($ch, CURLOPT_COOKIEJAR, &#8220;c:cookie.txt&#8221;);<br \/>\ncurl_setopt ($ch, CURLOPT_HEADER, 1);<br \/>\ncurl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);<br \/>\ncurl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 1);<br \/>\ncurl_setopt ($ch, CURLOPT_TIMEOUT, 120);<br \/>\n$result = curl_exec ($ch);<br \/>\ncurl_close($ch);<br \/>\nreturn $result;<\/p>\n<p>}<\/p>\n<p>$url_page = &#8220;<a href=\"http:\/\/www.google.com\/\">http:\/\/www.google.com<\/a>&#8220;;<br \/>\n$user_agent = &#8220;Mozilla\/4.0&#8221;;<br \/>\n$proxy = &#8220;<a href=\"http:\/\/192.11.222.124:8000\/\">http:\/\/192.11.222.124:8000<\/a>&#8220;;<br \/>\n$string = curl_string($url_page,$user_agent,$proxy);<br \/>\necho $string;<br \/>\n?&gt;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>\u5728PHP\u5f00\u53d1\u4e2d\uff0c\u6709\u65f6\u5019\u9700\u8981\u5728\u5185 \u90e8\u7f51\u4e2d\u8fdb\u884c\u5f00\u53d1\u3002\u5bf9\u4e8e\u6570\u636e\u6536\u96c6\u9879\u76ee\uff0c\u6709\u65f6\u5019\u670d\u52a1\u5668\u9700\u8981\u8fde\u63a5Internet\u7f51\u7edc\u6765\u83b7 [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[22],"tags":[42],"class_list":["post-49","post","type-post","status-publish","format-standard","hentry","category-php","tag-php"],"_links":{"self":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/49","targetHints":{"allow":["GET"]}}],"collection":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcomments&post=49"}],"version-history":[{"count":0,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/49\/revisions"}],"wp:attachment":[{"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fmedia&parent=49"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcategories&post=49"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Ftags&post=49"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}