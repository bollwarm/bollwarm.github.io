{"id":46,"date":"2013-11-30T00:00:00","date_gmt":"2013-11-29T16:00:00","guid":{"rendered":"http:\/\/ijz.me\/?p=46"},"modified":"2013-11-30T00:00:00","modified_gmt":"2013-11-29T16:00:00","slug":"oracle%e5%b8%b8%e7%94%a8%e8%af%ad%e5%8f%a51","status":"publish","type":"post","link":"http:\/\/ijz.me\/?p=46","title":{"rendered":"Oracle\u5e38\u7528\u8bed\u53e51"},"content":{"rendered":"<p><strong>\u7b2c\u4e00\u7ae0\uff1a\u65e5\u5fd7\u7ba1\u7406<\/strong><br \/>\n1.forcing log switches<br \/>\nsql&gt; alter system switch logfile;<br \/>\n2.forcing checkpoints<br \/>\nsql&gt; alter system checkpoint;<br \/>\n3.adding online redo log groups<br \/>\nsql&gt; alter database add logfile [group 4]<br \/>\nsql&gt; (\u2018\/disk3\/log4a.rdo\u2018,\u2018\/disk4\/log4b.rdo\u2018) size 1m;<br \/>\n4.adding online redo log members<br \/>\nsql&gt; alter database add logfile member<br \/>\nsql&gt; \u2018\/disk3\/log1b.rdo\u2018 to group 1,<br \/>\nsql&gt; \u2018\/disk4\/log2b.rdo\u2018 to group 2;<br \/>\n5.changes the name of the online redo logfile<br \/>\nsql&gt; alter database rename file \u2018c:\/oracle\/oradata\/oradb\/redo01.log\u2018<br \/>\nsql&gt; to \u2018c:\/oracle\/oradata\/redo01.log\u2018;<br \/>\n6.drop online redo log groups<br \/>\nsql&gt; alter database drop logfile group 3;<br \/>\n7.drop online redo log members<br \/>\nsql&gt; alter database drop logfile member \u2018c:\/oracle\/oradata\/redo01.log\u2018;<br \/>\n8.clearing online redo log files<br \/>\nsql&gt; alter database clear [unarchived] logfile \u2018c:\/oracle\/log2a.rdo\u2018;<br \/>\n9.using logminer analyzing redo logfiles<br \/>\na. in the init.ora specify utl_file_dir = \u2018 \u2018<br \/>\nb. sql&gt; execute dbms_logmnr_d.build(\u2018oradb.ora\u2018,\u2018c:oracleoradblog\u2018);<br \/>\nc. sql&gt; execute dbms_logmnr_add_logfile(\u2018c:oracleoradataoradbredo01.log\u2018,<br \/>\nsql&gt; dbms_logmnr.new);<br \/>\nd. sql&gt; execute dbms_logmnr.add_logfile(\u2018c:oracleoradataoradbredo02.log\u2018,<br \/>\nsql&gt; dbms_logmnr.addfile103f);<br \/>\ne. sql&gt; execute dbms_logmnr.start_logmnr(dictfilename=&gt;\u2018c:oracleoradblogoradb.ora\u2018);<br \/>\nf. sql&gt; select * from v$logmnr_post_contents(v$logmnr_dictionary,v$logmnr_parameters<br \/>\nsql&gt; v$logmnr_logs);<br \/>\ng. sql&gt; execute dbms_logmnr.end_logmnr;<\/p>\n<p><!--more--><\/p>\n<p><strong>\u7b2c\u4e8c\u7ae0\uff1a\u8868\u7a7a\u95f4\u7ba1\u7406<\/strong><br \/>\n1.create tablespaces<br \/>\nsql&gt; create tablespace tablespace_name datafile \u2018c:oracleoradatafile1.dbf\u2018 size 100m,<br \/>\nsql&gt; \u2018c:oracleoradatafile2.dbf\u2018 size 100m minimum extent 550k [logging\/nologging]<br \/>\nsql&gt; default storage (initial 500k next 500k maxextents 500 pctinccease 0)<br \/>\nsql&gt; [online\/offline] [permanent\/temporary] [extent_management_clause]<br \/>\n2.locally managed tablespace<br \/>\nsql&gt; create tablespace user_data datafile \u2018c:oracleoradatauser_data01.dbf\u2018<br \/>\nsql&gt; size 500m extent management local uniform size 10m;<br \/>\n3.temporary tablespace<br \/>\nsql&gt; create temporary tablespace temp tempfile \u2018c:oracleoradatatemp01.dbf\u2018<br \/>\nsql&gt; size 500m extent management local uniform size 10m;<br \/>\n4.change the storage setting<br \/>\nsql&gt; alter tablespace app_data minimum extent 2m;<br \/>\nsql&gt; alter tablespace app_data default storage(initial 2m next 2m<br \/>\naxextents 999);<br \/>\n5.taking tablespace offline or online<br \/>\nsql&gt; alter tablespace app_data offline;<br \/>\nsql&gt; alter tablespace app_data online;<br \/>\n6.read_only tablespace<br \/>\nsql&gt; alter tablespace app_data read only|write;<br \/>\n7.droping tablespace<br \/>\nsql&gt; drop tablespace app_data including post_contents;<br \/>\n8.enableing automatic extension of data files<br \/>\nsql&gt; alter tablespace app_data add datafile \u2018c:oracleoradataapp_data01.dbf\u2018 size 200m<br \/>\nsql&gt; autoextend on next 10m maxsize 500m;<br \/>\n9.change the size fo data files manually<br \/>\nsql&gt; alter database datafile \u2018c:oracleoradataapp_data.dbf\u2018 resize 200m;<br \/>\n10.Moving data files: alter tablespace<br \/>\nsql&gt; alter tablespace app_data rename datafile \u2018c:oracleoradataapp_data.dbf\u2018<br \/>\nsql&gt; to \u2018c:oracleapp_data.dbf\u2018;<br \/>\n11.moving data files:alter database<br \/>\nsql&gt; alter database rename file \u2018c:oracleoradataapp_data.dbf\u2018<br \/>\nsql&gt; to \u2018c:oracleapp_data.dbf\u2018;<\/p>\n<p><strong>\u7b2c\u4e09\u7ae0\uff1a\u8868<\/strong><br \/>\n1.create a table<br \/>\nsql&gt; create table table_name (column datatype,column datatype]&#8230;.)<br \/>\nsql&gt; tablespace tablespace_name [pctfree integer] [pctused integer]<br \/>\nsql&gt; [initrans integer] [maxtrans integer]<br \/>\nsql&gt; storage(initial 200k next 200k pctincrease 0 maxextents 50)<br \/>\nsql&gt; [logging|nologging] [cache|nocache]<br \/>\n2.copy an existing table<br \/>\nsql&gt; create table table_name [logging|nologging] as subquery<br \/>\n3.create temporary table<br \/>\nsql&gt; create global temporary table xay_temp as select * from xay;<br \/>\non commit preserve rows\/on commit delete rows<br \/>\n4.pctfree = (average row size &#8211; initial row size) *100 \/average row size<br \/>\npctused = 100-pctfree- (average row size*100\/available data space)<br \/>\n5.change storage and block utilization parameter<br \/>\nsql&gt; alter table table_name pctfree=30 pctused=50 storage(next 500k<br \/>\nsql&gt; minextents 2 maxextents 100);<br \/>\n6.manually allocating extents<br \/>\nsql&gt; alter table table_name allocate extent(size 500k datafile \u2018c:\/oracle\/data.dbf\u2018);<br \/>\n7.move tablespace<br \/>\nsql&gt; alter table employee move tablespace users;<br \/>\n8.deallocate of unused space<br \/>\nsql&gt; alter table table_name deallocate unused [keep integer]<br \/>\n9.truncate a table<br \/>\nsql&gt; truncate table table_name;<br \/>\n10.drop a table<br \/>\nsql&gt; drop table table_name [cascade constraints];<br \/>\n11.drop a column<br \/>\nsql&gt; alter table table_name103f drop column comments cascade constraints checkpoint 1000;<br \/>\nalter table table_name drop columns continue;<br \/>\n12.mark a column as unused<br \/>\nsql&gt; alter table table_name set unused column comments cascade constraints;<br \/>\nalter table table_name drop unused columns checkpoint 1000;<br \/>\nalter table orders drop columns continue checkpoint 1000<br \/>\ndata_dictionary : dba_unused_col_tabs<\/p>\n<p><strong>\u7b2c\u56db\u7ae0\uff1a\u7d22\u5f15<\/strong><br \/>\n1.creating function-based indexes<br \/>\nsql&gt; create index summit.item_quantity on summit.item(quantity-quantity_shipped);<br \/>\n2.create a B-tree index<br \/>\nsql&gt; create [unique] index index_name on table_name(column,.. asc\/desc)<br \/>\ntablespace<br \/>\nsql&gt; tablespace_name [pctfree integer] [initrans integer] [maxtrans integer]<br \/>\nsql&gt; [logging | nologging] [nosort] storage(initial 200k next 200k pctincrease 0<br \/>\nsql&gt; maxextents 50);<br \/>\n3.pctfree(index)=(maximum number of rows-initial number of rows)*100\/maximum number of rows<br \/>\n4.creating reverse key indexes<br \/>\nsql&gt; create unique index xay_id on xay(a) reverse pctfree 30 storage(initial 200k<br \/>\nsql&gt; next 200k pctincrease 0 maxextents 50) tablespace indx;<br \/>\n5.create bitmap index<br \/>\nsql&gt; create bitmap index xay_id on xay(a) pctfree 30 storage( initial 200k next 200k<br \/>\nsql&gt; pctincrease 0 maxextents 50) tablespace indx;<br \/>\n6.change storage parameter of index<br \/>\nsql&gt; alter index xay_id storage (next 400k maxextents 100);<br \/>\n7.allocating index space<br \/>\nsql&gt; alter index xay_id allocate extent(size 200k datafile<br \/>\n\u2018c:\/oracle\/index.dbf\u2018);<br \/>\n8.alter index xay_id deallocate unused;<\/p>\n<p><strong>\u7b2c\u4e94\u7ae0\uff1a\u7ea6\u675f<\/strong><br \/>\n1.define constraints as immediate or deferred<br \/>\nsql&gt; alter session set constraint[s] = immediate\/deferred\/default;<br \/>\nset constraint[s] constraint_name\/all immediate\/deferred;<br \/>\n2. sql&gt; drop table table_name cascade constraints<br \/>\nsql&gt; drop tablespace tablespace_name including post_contents cascade constraints<br \/>\n3. define constraints while create a table<br \/>\nsql&gt; create table xay(id number(7) constraint xay_id primary key deferrable<br \/>\nsql&gt; using index storage(initial 100k next 100k) tablespace indx);<br \/>\nprimary key\/unique\/references table(column)\/check<br \/>\n4.enable constraints<br \/>\nsql&gt; alter table xay enable novalidate constraint xay_id;<br \/>\n5.enable constraints<br \/>\nsql&gt; alter table xay enable validate constraint xay_id;<\/p>\n<p><strong>\u7b2c\u516d\u7ae0\uff1a<\/strong><strong>LOAD<\/strong><strong>\u6570\u636e<\/strong><br \/>\n1.loading data using direct_load insert<br \/>\nsql&gt; insert \/*+append *\/ into emp nologging<br \/>\nsql&gt; select * from emp_old;<br \/>\n2.parallel direct-load insert<br \/>\nsql&gt; alter session enable parallel dml;<br \/>\nsql&gt; insert \/*+parallel(emp,2) *\/ into emp nologging<br \/>\nsql&gt; select * from emp_old;<br \/>\n3.using sql*loader<br \/>\nsql&gt; sqlldr scott\/tiger sql&gt; control = ulcase6.ctl sql&gt; log = ulcase6.log direct=true<\/p>\n","protected":false},"excerpt":{"rendered":"<p>\u7b2c\u4e00\u7ae0\uff1a\u65e5\u5fd7\u7ba1\u7406 1.forcing log switches sql&gt; alter system sw [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[20],"tags":[],"class_list":["post-46","post","type-post","status-publish","format-standard","hentry","category-oracle"],"_links":{"self":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/46","targetHints":{"allow":["GET"]}}],"collection":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcomments&post=46"}],"version-history":[{"count":0,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/46\/revisions"}],"wp:attachment":[{"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fmedia&parent=46"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcategories&post=46"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Ftags&post=46"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}