{"id":816,"date":"2015-12-06T21:24:23","date_gmt":"2015-12-06T13:24:23","guid":{"rendered":"http:\/\/ijz.me\/?p=816"},"modified":"2015-12-06T21:24:23","modified_gmt":"2015-12-06T13:24:23","slug":"rex-advent-rex-%e5%8a%a0%e5%af%86rexfile%e4%b8%ad%e8%b4%a6%e5%8f%b7%e5%92%8c%e8%af%81%e4%b9%a6%e4%bf%a1%e6%81%af-2","status":"publish","type":"post","link":"http:\/\/ijz.me\/?p=816","title":{"rendered":"rex advent\u2014\u2014 rex \u521b\u5efa\u7528\u6237\u5e76\u8ffd\u52a0\u672c\u5730\u591a\u6587\u4ef6ssh\u516c\u94a5\u5230\u8fdc\u7a0b\u670d\u52a1\u5668\u7528\u6237"},"content":{"rendered":"<p>\u7ba1\u7406\u7528\u6237\u5bc6\u94a5\u6bd4\u8f83\u7e41\u7410\uff0c\u5c24\u5176\u662f\u591a\u5bc6\u94a5\u65f6\u5019\uff0c\u4e0b\u9762\u7ed9\u51fa\u4e00\u79cd\u65b9\u6cd5\uff1a<\/p>\n<pre class=\"lang:default decode:true \">task \"my_user\", sub {\n\n  my $local_keys = LOCAL{\n    my @key_files = qw(\n      \/root\/.ssh\/id_rsa.pub\n      \/home\/user\/.ssh\/id_rsa.pub\n    );\n    my @tmp;\n    push ( @tmp, split \"n\", cat $_ ) foreach @key_files;\n    return @tmp;\n  };\n\n  my @remote_keys = split \"n\", cat '~\/.ssh\/authorized_keys';\n\n  create_user \"myuser\",\n              home        =&gt; '\/home\/myuser',\n              comment     =&gt; 'My user',\n              expire      =&gt; '2100-05-30',\n              password    =&gt; 'password',\n              system      =&gt; 1,\n              create_home =&gt; TRUE,\n              ssh_key     =&gt; join \"n\", @$local_keys, @remote_keys;\n say connection-&gt;server;\n};\n<\/pre>\n<p><!--more--><\/p>\n<p>\u5bf9\u4e8e\u5df2\u7ecf\u521b\u5efa\u7528\u6237\uff0c\u5e76\u4e14\u8fdc\u7a0b\u8bc1\u4e66\u6587\u4ef6\u5df2\u7ecf\u5b58\u5728\u7684\uff0c\u8ffd\u52a0\u65f6\u5019\u76f4\u63a5\u8ffd\u52a0\u7528\u6237\u8bc1\u4e66<\/p>\n<pre class=\"lang:default decode:true \">  task \"addkeys\", group =&gt; \"all\", sub {\n\n  my $local_keys = LOCAL{\n    my @key_files = qw(\n      \/root\/.ssh\/id_rsa.pub\n      \/home\/user\/.ssh\/id_rsa.pub\n    );\n    my @tmp;\n    push ( @tmp, split \"n\", cat $_ ) foreach @key_files;\n    return @tmp;\n  };\n\n  my @remote_keys = split \"n\", cat '~\/.ssh\/authorized_keys';\n\n  run  'echo @$local_keys &gt;&gt;\/home\/ZX_lz\/.ssh\/authorized_keys';\n\n\n    say connection-&gt;server;\n  }<\/pre>\n<p>&nbsp;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>\u7ba1\u7406\u7528\u6237\u5bc6\u94a5\u6bd4\u8f83\u7e41\u7410\uff0c\u5c24\u5176\u662f\u591a\u5bc6\u94a5\u65f6\u5019\uff0c\u4e0b\u9762\u7ed9\u51fa\u4e00\u79cd\u65b9\u6cd5\uff1a task &#8220;my_user&#8221;, sub { my  [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[21,23],"tags":[29,40,44],"class_list":["post-816","post","type-post","status-publish","format-standard","hentry","category-perl","category-rex","tag-advent","tag-perl","tag-rex"],"_links":{"self":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/816","targetHints":{"allow":["GET"]}}],"collection":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcomments&post=816"}],"version-history":[{"count":0,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/816\/revisions"}],"wp:attachment":[{"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fmedia&parent=816"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcategories&post=816"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Ftags&post=816"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}