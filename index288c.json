{"id":755,"date":"2015-08-16T22:34:35","date_gmt":"2015-08-16T14:34:35","guid":{"rendered":"http:\/\/ijz.me\/?p=755"},"modified":"2015-08-16T22:34:35","modified_gmt":"2015-08-16T14:34:35","slug":"nginx%e6%97%a5%e5%bf%97%e8%87%aa%e5%8a%a8%e5%88%87%e5%89%b2%e4%bb%a5%e6%b8%85%e7%90%86","status":"publish","type":"post","link":"http:\/\/ijz.me\/?p=755","title":{"rendered":"nginx\u65e5\u5fd7\u81ea\u52a8\u5207\u5272\u4ee5\u6e05\u7406"},"content":{"rendered":"<p>   \u6309\u65e5\u81ea\u52a8\u5207\u5272nginx\u65e5\u5fd7\uff0c\u5e76\u5220\u966430\uff08\u53ef\u81ea\u5b9a\u4e49\uff09\u5929\u4ee5\u4e0a\u7684\u65e5\u5fd7\u3002<br \/>\n\u811a\u672c\u4fdd\u5b58\u4e3a \/nginx\/logs\/ngx_logcut.sh \u5e76\u52a0\u5165crontab\u4e2d<\/p>\n<pre class=\"lang:default decode:true \" >#!\/bin\/bash\n# 0 00 * * * \/nginx\/logs\/ngx_logcut.sh  &gt;\/dev\/null 2&gt;&amp;\npidfile=\/var\/run\/nginx.pid\nlogpath='\/nginx\/logs\/'\nkeepdays=30\nlogfiles=(access.log error.log)\ncd $logpath\n\nfor logfile in ${logfiles[@]}; do\n    if [ ! -e $logfile ];\n    then\n        continue\n    fi\n    find . -type f -name $logfile\"20*\" -mtime +$keepdays -exec rm {} ;\n    mv $logfile $logfile$(date -d \"yesterday\" +\"%Y%m%d\")\ndone\n\nkill -USR1 `cat $pidfile`<\/pre>\n","protected":false},"excerpt":{"rendered":"<p>\u6309\u65e5\u81ea\u52a8\u5207\u5272nginx\u65e5\u5fd7\uff0c\u5e76\u5220\u966430\uff08\u53ef\u81ea\u5b9a\u4e49\uff09\u5929\u4ee5\u4e0a\u7684\u65e5\u5fd7\u3002 \u811a\u672c\u4fdd\u5b58\u4e3a \/nginx\/logs\/ngx_ [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[2,24],"tags":[38],"class_list":["post-755","post","type-post","status-publish","format-standard","hentry","category-linux","category-shell","tag-nginx"],"_links":{"self":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/755","targetHints":{"allow":["GET"]}}],"collection":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcomments&post=755"}],"version-history":[{"count":0,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/755\/revisions"}],"wp:attachment":[{"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fmedia&parent=755"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcategories&post=755"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Ftags&post=755"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}