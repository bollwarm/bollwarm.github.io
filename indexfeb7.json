{"id":47,"date":"2013-11-30T00:00:00","date_gmt":"2013-11-29T16:00:00","guid":{"rendered":"http:\/\/ijz.me\/?p=47"},"modified":"2013-11-30T00:00:00","modified_gmt":"2013-11-29T16:00:00","slug":"oracle%e5%b8%b8%e7%94%a8%e8%af%ad%e5%8f%a52","status":"publish","type":"post","link":"http:\/\/ijz.me\/?p=47","title":{"rendered":"oracle\u5e38\u7528\u8bed\u53e52"},"content":{"rendered":"<p><strong>\u7b2c\u4e03\u7ae0\uff1a<\/strong><strong>reorganizing data<\/strong><br \/>\n1.using expoty<br \/>\n$exp scott\/tiger tables(dept,emp) file=c:emp.dmp log=exp.log compress=n direct=y<br \/>\n2.using import<br \/>\n$imp scott\/tiger tables(dept,emp) file=emp.dmp log=imp.log ignore=y<br \/>\n3.transporting a tablespace<br \/>\nsql&gt;alter tablespace sales_ts read only;<br \/>\n$exp sys\/.. file=xay.dmp transport_tablespace=y tablespace=sales_ts<br \/>\ntriggers=n constraints=n<br \/>\n$copy datafile<br \/>\n$imp sys\/.. file=xay.dmp transport_tablespace=y datafiles=(\/disk1\/sles01.dbf,\/disk2<br \/>\n\/sles02.dbf)<br \/>\nsql&gt; alter tablespace sales_ts read write;<br \/>\n4.checking transport set<br \/>\nsql&gt; DBMS_tts.transport_set_check<br \/>\n(ts_list =&gt;\u2018sales_ts\u2018 ..,incl_constraints=&gt;true);<br \/>\n\u5728\u8868transport_set_violations \u4e2d\u67e5\u770b<br \/>\nsql&gt; dbms_tts.isselfcontained \u4e3atrue \u662f\uff0c \u8868\u793a\u81ea\u5305\u542b<br \/>\n<!--more--><br \/>\n<strong>\u7b2c\u516b\u7ae0\uff1a<\/strong><strong> managing password security and resources<\/strong><br \/>\n1.controlling account lock and password<br \/>\nsql&gt; alter user juncky identified by oracle account unlock;<br \/>\n2.user_provided password function<br \/>\nsql&gt; function_name(userid in varchar2(30),password in varchar2(30),<br \/>\nold_password in varchar2(30)) return boolean<br \/>\n3.create a profile : password setting<br \/>\nsql&gt; create profile grace_5 limit failed_login_attempts 3<br \/>\nsql&gt; password_lock_time unlimited password_life_time 30<br \/>\nsql&gt;password_reuse_tim103fe 30 password_verify_function verify_function<br \/>\nsql&gt; password_grace_time 5;<br \/>\n4.altering a profile<br \/>\nsql&gt; alter profile default failed_login_attempts 3<br \/>\nsql&gt; password_life_time 60 password_grace_time 10;<br \/>\n5.drop a profile<br \/>\nsql&gt; drop profile grace_5 [cascade];<br \/>\n6.create a profile : resource limit<br \/>\nsql&gt; create profile developer_prof limit sessions_per_user 2<br \/>\nsql&gt; cpu_per_session 10000 idle_time 60 connect_time 480;<br \/>\n7. view =&gt; resource_cost : alter resource cost<br \/>\ndba_Users,dba_profiles<br \/>\n8. enable resource limits<br \/>\nsql&gt; alter system set resource_limit=true;<\/p>\n<p><strong>\u7b2c\u4e5d\u7ae0\uff1a<\/strong><strong>Managing users<\/strong><br \/>\n1.create a user: database authentication<br \/>\nsql&gt; create user juncky identified by oracle default tablespace users<br \/>\nsql&gt; temporary tablespace temp quota 10m on data password expire<br \/>\nsql&gt; [account lock|unlock] [profile profilename|default];<br \/>\n2.change user quota on tablespace<br \/>\nsql&gt; alter user juncky quota 0 on users;<br \/>\n3.drop a user<br \/>\nsql&gt; drop user juncky [cascade];<br \/>\n4. monitor user<br \/>\nview: dba_users , dba_ts_quotas<\/p>\n<p><strong>\u7b2c\u5341\u7ae0\uff1a<\/strong><strong>managing privileges<\/strong><br \/>\n1.system privileges: view =&gt; system_privilege_map ,dba_sys_privs,session_privs<br \/>\n2.grant system privilege<br \/>\nsql&gt; grant create session,create table to managers;<br \/>\nsql&gt; grant create session to scott with admin option;<br \/>\nwith admin option can grant or revoke privilege from any user or role;<br \/>\n3.sysdba and sysoper privileges:<br \/>\nsysoper: startup,shutdown,alter database open|mount,alter database backup controlfile,<br \/>\nalter tablespace begin\/end backup,recover database<br \/>\nalter database archivelog,restricted session<br \/>\nsysdba: sysoper privileges with admin option,create database,recover database until<br \/>\n4.password file members: view:=&gt; v$pwfile_users<br \/>\n5.O7_dictionary_accessibility =true restriction access to view or tables in other schema<br \/>\n6.revoke system privilege<br \/>\nsql&gt; revoke create table from karen;<br \/>\nsql&gt; revoke create session from scott;<br \/>\n7.grant object privilege<br \/>\nsql&gt; grant execute on dbms_pipe to public;<br \/>\nsql&gt; grant update(first_name,salary) on employee to karen with grant option;<br \/>\n8.display object privilege : view =&gt; dba_tab_privs, dba_col_privs<br \/>\n9.revoke object privilege<br \/>\nsql&gt; revoke execute on dbms_pipe from scott [cascade constraints];<br \/>\n10.audit record view :=&gt; sys.aud$<br \/>\n11. protecting the audit trail<br \/>\nsql&gt; audit delete on sys.aud$ by access;<br \/>\n12.statement auditing<br \/>\nsql&gt; audit user;<br \/>\n13.privilege auditing<br \/>\nsql&gt; audit select any table by summit by access;<br \/>\n14.schema object auditing<br \/>\nsql&gt; audit lock on summit.employee by access whenever successful;<br \/>\n15.view audit option : view=&gt; all_def_audit_opts,dba_stmt_audit_opts,dba_priv_audit_opts,dba_obj_audit_opts<br \/>\n16.view audit result: view=&gt; dba_audit_trail,dba_audit_exists,dba_audit_object,<br \/>\ndba_audit_session,dba_audit_statement<\/p>\n<p><strong>\u7b2c\u5341\u4e00\u7ae0\uff1a<\/strong><strong> manager role<\/strong><br \/>\n1.create roles<br \/>\nsql&gt; create role sales_clerk;<br \/>\nsql&gt; create role hr_clerk identified by bonus;<br \/>\nsql&gt; create role hr_manager identified externally;<br \/>\n2.modify role<br \/>\nsql&gt; alter role sales_clerk identified by commission;<br \/>\nsql&gt; alter role hr_clerk identified externally;<br \/>\nsql&gt; alter role hr_manager not identified;<br \/>\n3.assigning roles<br \/>\nsql&gt; grant sales_clerk to scott;<br \/>\nsql&gt; grant hr_clerk to hr_manager;<br \/>\nsql&gt; grant hr_manager to scott with admi103fn option;<br \/>\n4.establish default role<br \/>\nsql&gt; alter user scott default role hr_clerk,sales_clerk;<br \/>\nsql&gt; alter user scott default role all;<br \/>\nsql&gt; alter user scott default role all except hr_clerk;<br \/>\nsql&gt; alter user scott default role none;<br \/>\n5.enable and disable roles<br \/>\nsql&gt; set role hr_clerk;<br \/>\nsql&gt; set role sales_clerk identified by commission;<br \/>\nsql&gt; set role all except sales_clerk;<br \/>\nsql&gt; set role none;<br \/>\n6.remove role from user<br \/>\nsql&gt; revoke sales_clerk from scott;<br \/>\nsql&gt; revoke hr_manager from public;<br \/>\n7.remove role<br \/>\nsql&gt; drop role hr_manager;<br \/>\n8.display role information<br \/>\nview: =&gt;dba_roles,dba_role_privs,role_role_privs,dba_sys_privs,<br \/>\nrole_sys_privs,role_tab_privs,session_roles<\/p>\n<p><strong>\u7b2c\u5341\u4e8c\u7ae0<\/strong><strong>: BACKUP and RECOVERY<\/strong><br \/>\n1. v$sga,v$instance,v$process,v$bgprocess,v$database,v$datafile,v$sgastat<br \/>\n2. Rman need set dbwr_IO_slaves or backup_tape_IO_slaves and large_pool_size<br \/>\n3. Monitoring Parallel Rollback<br \/>\n&gt; v$fast_start_servers , v$fast_start_transactions<br \/>\n4.perform a closed database backup (noarchivelog)<br \/>\n&gt; shutdown immediate<br \/>\n&gt; cp files \/backup\/<br \/>\n&gt; startup<br \/>\n5.restore to a different location<br \/>\n&gt; connect system\/manager as sysdba<br \/>\n&gt; startup mount<br \/>\n&gt; alter database rename file \u2018\/disk1\/..\/user.dbf\u2018 to \u2018\/disk2\/..\/user.dbf\u2018;<br \/>\n&gt; alter database open;<br \/>\n6.recover syntax<br \/>\n&#8211;recover a mounted database<br \/>\n&gt;recover database;<br \/>\n&gt;recover datafile \u2018\/disk1\/data\/df2.dbf\u2018;<br \/>\n&gt;alter database recover database;<br \/>\n&#8211;recover an opened database<br \/>\n&gt;recover tablespace user_data;<br \/>\n&gt;recover datafile 2;<br \/>\n&gt;alter database recover datafile 2;<br \/>\n7.how to apply redo log files automatically<br \/>\n&gt;set autorecovery on<br \/>\n&gt;recover automatic datafile 4;<br \/>\n8.complete recovery:<br \/>\n&#8211;method 1(mounted databae)<br \/>\n&gt;copy c:backupuser.dbf c:oradatauser.dbf<br \/>\n&gt;startup mount<br \/>\n&gt;recover datafile \u2018c:oradatauser.dbf;<br \/>\n&gt;alter database open;<br \/>\n&#8211;method 2(opened database,initially opened,not system or rollback datafile)<br \/>\n&gt;copy c:backupuser.dbf c:oradatauser.dbf (alter tablespace offline)<br \/>\n&gt;recover datafile \u2018c:oradatauser.dbf\u2018 or<br \/>\n&gt;recover tablespace user_data;<br \/>\n&gt;alter database datafile \u2018c:oradatauser.dbf\u2018 online or<br \/>\n&gt;alter tablespace user_data online;<br \/>\n&#8211;method 3(opened database,initially closed not system or rollback datafile)<br \/>\n&gt;startup mount<br \/>\n&gt;alter database datafile \u2018c:oradatauser.dbf\u2018 offline;<br \/>\n&gt;alter database open<br \/>\n&gt;copy c:backupuser.dbf d:oradatauser.dbf<br \/>\n&gt;alter database rename file \u2018c:oradatauser.dbf\u2018 to \u2018d:oradatauser.dbf\u2018<br \/>\n&gt;recover datafile \u2018e:oradatauser.dbf\u2018 or recover tablespace user_data;<br \/>\n&gt;alter tablespace user_data online;<br \/>\n&#8211;method 4(loss of data file with no backup and have all archive log)<br \/>\n&gt;alter tablespace user_data offline immediate;<br \/>\n&gt;alter database create datafile \u2018d:oradatauser.dbf\u2018 as \u2018c:oradatauser.dbf\u2018\u2018<br \/>\n&gt;recover tablespace user_data;<br \/>\n&gt;alter tablespace user_data online<br \/>\n5.perform an open database backup<br \/>\n&gt; alter tablespace user_data begin backup;<br \/>\n&gt; copy files \/backup\/<br \/>\n&gt; alter database datafile \u2018\/c:\/..\/data.dbf\u2018 end backup;<br \/>\n&gt; alter system switch logfile;<br \/>\n6.backup a control file<br \/>\n&gt; alter database backup controlfile to \u2018control1.bkp\u2018;<br \/>\n&gt; alter database backup controlfile to trace;<br \/>\n7.recovery 103f(noarchivelog mode)<br \/>\n&gt; shutdown abort<br \/>\n&gt; cp files<br \/>\n&gt; startup<br \/>\n8.recovery of file in backup mode<br \/>\n&gt;alter database datafile 2 end backup;<br \/>\n9.clearing redo log file<br \/>\n&gt;alter database clear unarchived logfile group 1;<br \/>\n&gt;alter database clear unarchived logfile group 1 unrecoverable datafile;<br \/>\n10.redo log recovery<br \/>\n&gt;alter database add logfile group 3 \u2018c:oradataredo03.log\u2018 size 1000k;<br \/>\n&gt;alter database drop logfile group 1;<br \/>\n&gt;alter database open;<br \/>\nor &gt;cp c:oradataredo02.log\u2018 c:oradataredo01.log<br \/>\n&gt;alter database clear logfile \u2018c:oradatalog01.log\u2018;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>\u7b2c\u4e03\u7ae0\uff1areorganizing data 1.using expoty $exp scott\/tiger t [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[20],"tags":[],"class_list":["post-47","post","type-post","status-publish","format-standard","hentry","category-oracle"],"_links":{"self":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/47","targetHints":{"allow":["GET"]}}],"collection":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcomments&post=47"}],"version-history":[{"count":0,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/47\/revisions"}],"wp:attachment":[{"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fmedia&parent=47"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcategories&post=47"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Ftags&post=47"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}