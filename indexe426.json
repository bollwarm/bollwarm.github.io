{"id":582,"date":"2014-07-07T17:16:04","date_gmt":"2014-07-07T09:16:04","guid":{"rendered":"http:\/\/ijz.me\/?p=582"},"modified":"2014-07-07T17:16:04","modified_gmt":"2014-07-07T09:16:04","slug":"rex%e7%82%b9%e6%bb%b4","status":"publish","type":"post","link":"http:\/\/ijz.me\/?p=582","title":{"rendered":"rex\u70b9\u6ef4"},"content":{"rendered":"<p>\u663e\u793a\u4efb\u52a1\u6267\u884c\u4fe1\u606f\uff0c\u53bb\u6389\u8fc7\u7a0b\u548c\u9519\u8bef\u4fe1\u606f<\/p>\n<p>rex -qw uptime<\/p>\n<p>\u628a\u6267\u884c\u7ed3\u679c\u5b58\u5230\u6587\u4ef6\u4e2d<\/p>\n<p>rex -qw uptime | tee -a info.log<\/p>\n<p>\u6307\u5b9a\u4e3b\u673a\u6267\u884c<\/p>\n<p>rex -qw -H &#8216;192.168.1.1 192.168.1.2&#8217; uptime<\/p>\n<p><!--more--><br \/>\n\u663e\u793a\u4e3b\u673aip\u7684<\/p>\n<p>my $output = run &#8220;uptime&#8221;;<br \/>\nsay connection-&gt;server.$output;<\/p>\n<p>\u591a\u8fdb\u7a0b<\/p>\n<p>parallelism n;<\/p>\n<p>sudo\u6267\u884c\uff1a<br \/>\nsudo TRUE;<br \/>\nsudo_password &#8216;ttrttr&#8217;;<\/p>\n<p>\u6307\u5b9a\u5206\u7ec4\u6267\u884c temp\uff1a<\/p>\n<p>rex -qw -G temp $task<\/p>\n<p>\u5217\u51fa\u547d\u4ee4\u9879\u76ee rex -h<\/p>\n<p>\u5217\u51fa\u4efb\u52a1\u548c\u5206\u7ec4\u5217\u8868 rex -T<\/p>\n<p>\u901a\u8fc7\u6587\u4ef6\u6267\u884c\u5b9a\u4e49\u4efb\u52a1<\/p>\n<p>rex -qw creatuser -f usermange<\/p>\n<p><strong>\u4efb\u52a1sample<\/strong><\/p>\n<p>\u6dfb\u52a0sudo<br \/>\ntask &#8220;addsudo&#8221;,group =&gt;&#8221;all&#8221;, sub {<br \/>\nappend_if_no_such_line &#8220;\/etc\/sudoers&#8221;, &#8220;yy ALL=(ALL) ALL&#8221;;<br \/>\nsay connection-&gt;server.&#8221; Sudo add success!&#8221;;<br \/>\n};<\/p>\n<p>\u5220\u9664\u7528\u6237<\/p>\n<p>task &#8220;addsudo&#8221;,group =&gt;&#8221;all&#8221;, sub {<br \/>\nappend_if_no_such_line &#8220;\/etc\/sudoers&#8221;, &#8220;yy ALL=(ALL) ALL&#8221;;<br \/>\nsay connection-&gt;server.&#8221; Sudo add success!&#8221;;<br \/>\n};<\/p>\n<p>\u521b\u5efa\u6216\u8005\u4fee\u6539\u7528\u6237<\/p>\n<p>task &#8220;create-user&#8221;,group =&gt; &#8220;all&#8221;, sub {<\/p>\n<p>say connection-&gt;server.&#8221; begin create&#8221;;<\/p>\n<p>create_user &#8220;yy&#8221;,<br \/>\npassword =&gt; &#8216;yy123&#8217;;<br \/>\ncreate_user &#8220;xx&#8221;,<br \/>\npassword =&gt; &#8216;xx123&#8217;;<\/p>\n<p>say connection-&gt;server.&#8221; done!&#8221;;<br \/>\n};<\/p>\n<p>\u542f\u7528ini\u6587\u4ef6\u5b9a\u4e49\u5206\u7ec4:<br \/>\n&#8212;&#8212;&#8212;&#8212;&#8212;-<\/p>\n<p>use Rex -base;<br \/>\nuse Rex::Group::Lookup::INI;<br \/>\nuse Rex::Commands::User;<br \/>\nuser &#8220;yy&#8221;;<\/p>\n<p>password &#8216;ttrttr&#8217;;<\/p>\n<p>pass_auth;<\/p>\n<p>port 65522;<\/p>\n<p>groups_file &#8220;list.ini&#8221;;<\/p>\n<p>parallelism 10;<\/p>\n<p>ini\u6587\u4ef6<\/p>\n<p>list.ini<\/p>\n<p>[all]<\/p>\n<p>192.168.1.1<br \/>\n192.168.1.2<br \/>\n..<\/p>\n<p>&#8212;&#8212;&#8212;-<\/p>\n<p>&#8212;&#8212;&#8212;-<\/p>\n<p>\u670d\u52a1\u5217\u8868<\/p>\n<p>task &#8220;list&#8221;, group =&gt; &#8220;all&#8221;, sub {<\/p>\n<p>say connection-&gt;server;<\/p>\n<p>};<\/p>\n<p>&#8212;&#8212;&#8212;&#8211;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>\u663e\u793a\u4efb\u52a1\u6267\u884c\u4fe1\u606f\uff0c\u53bb\u6389\u8fc7\u7a0b\u548c\u9519\u8bef\u4fe1\u606f rex -qw uptime \u628a\u6267\u884c\u7ed3\u679c\u5b58\u5230\u6587\u4ef6\u4e2d rex -qw up [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"closed","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[21,23],"tags":[40,44],"class_list":["post-582","post","type-post","status-publish","format-standard","hentry","category-perl","category-rex","tag-perl","tag-rex"],"_links":{"self":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/582","targetHints":{"allow":["GET"]}}],"collection":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcomments&post=582"}],"version-history":[{"count":0,"href":"http:\/\/ijz.me\/index.php?rest_route=\/wp\/v2\/posts\/582\/revisions"}],"wp:attachment":[{"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fmedia&parent=582"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Fcategories&post=582"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/ijz.me\/index.php?rest_route=%2Fwp%2Fv2%2Ftags&post=582"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}